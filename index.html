<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DDNetwork One — Premium Web Systems</title>
  <meta name="description" content="DDNetwork One designs premium websites, portals, and AI‑assisted experiences for modern businesses." />
  <meta name="theme-color" content="#0b0f14" />
  <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/ddnetwork-one/ddnetwork-store/refs/heads/main/crop_ddnlogo.png" />

  <!-- Fonts: Sora (display) + Manrope (body) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700&family=Sora:wght@500;600;700&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

  <!-- RAZORPAY CHECKOUT SCRIPT -->
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

  <style>
    :root {
      --bg: #0b0f14;
      --bg-soft: #0f141b;
      --panel: rgba(255, 255, 255, 0.04);
      --panel-2: rgba(255, 255, 255, 0.06);
      --border: rgba(255, 255, 255, 0.08);
      --text: #e9eef5;
      --muted: #9fb0c4;

      --brand: #76f7d2;
      --brand-2: #8ab4ff;
      --brand-3: #ffd37c;

      --danger: #ff6b6b;
      --success: #10b981;
      --shadow: 0 20px 60px rgba(0,0,0,0.4);

      --font-display: "Sora", sans-serif;
      --font-body: "Manrope", sans-serif;

      --radius: 18px;
      --radius-lg: 28px;
      --ease: cubic-bezier(.16,1,.3,1);
      --header-h: 72px;
    }

    body.theme-light {
      --bg: #f5f7fb;
      --bg-soft: #ffffff;
      --panel: rgba(255,255,255,0.75);
      --panel-2: rgba(255,255,255,0.9);
      --border: rgba(15, 23, 42, 0.08);
      --text: #0b1220;
      --muted: #5f6c82;

      --brand: #0ea5e9;
      --brand-2: #6366f1;
      --brand-3: #f59e0b;
      --shadow: 0 20px 60px rgba(15, 23, 42, 0.12);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--font-body);
      line-height: 1.6;
      min-height: 100vh;
      overflow-x: hidden;
    }
    a { color: inherit; text-decoration: none; }
    img { display: block; max-width: 100%; }
    button { font-family: inherit; cursor: pointer; }
    .container { width: min(1200px, 92%); margin: 0 auto; }

    /* Background atmosphere */
    .bg-grid {
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(to right, rgba(255,255,255,0.03) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(255,255,255,0.03) 1px, transparent 1px);
      background-size: 64px 64px;
      pointer-events: none;
      z-index: 0;
      opacity: 0.35;
    }
    .orb {
      position: fixed;
      width: 420px;
      height: 420px;
      filter: blur(40px);
      opacity: 0.35;
      border-radius: 50%;
      z-index: 0;
      animation: float 18s ease-in-out infinite;
    }
    .orb.one {
      background: radial-gradient(circle, var(--brand), transparent 60%);
      top: -140px; right: 6%;
    }
    .orb.two {
      background: radial-gradient(circle, var(--brand-2), transparent 60%);
      bottom: -160px; left: 8%;
      animation-delay: -6s;
    }
    .orb.three {
      background: radial-gradient(circle, var(--brand-3), transparent 60%);
      top: 45%; left: 60%;
      animation-delay: -10s;
    }
    @keyframes float {
      0%,100% { transform: translateY(0); }
      50% { transform: translateY(18px); }
    }

    /* Progress bar */
    .progress {
      position: fixed;
      top: 0; left: 0;
      height: 3px;
      width: 100%;
      transform-origin: 0 50%;
      transform: scaleX(0);
      background: linear-gradient(90deg, var(--brand), var(--brand-2));
      z-index: 100;
    }

    /* Header */
    header {
      position: fixed;
      top: 16px; left: 50%;
      transform: translateX(-50%);
      width: min(1200px, 94%);
      height: var(--header-h);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 18px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(10,14,20,0.7);
      backdrop-filter: blur(18px);
      z-index: 50;
      transition: all 0.3s var(--ease);
    }
    body.theme-light header { background: rgba(255,255,255,0.85); }
    header.scrolled {
      top: 0;
      border-radius: 0;
      width: 100%;
      box-shadow: var(--shadow);
    }

    .logo {
      display: flex; align-items: center; gap: 12px;
      font-family: var(--font-display); font-weight: 700;
      letter-spacing: -0.02em;
    }
    .logo img { width: 34px; height: 34px; }

    nav.nav {
      display: none;
      gap: 10px;
      align-items: center;
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--muted);
    }
    nav.nav a {
      padding: 8px 12px;
      border-radius: 999px;
      transition: all 0.2s var(--ease);
    }
    nav.nav a.active {
      color: var(--text);
      background: var(--panel-2);
      border: 1px solid var(--border);
    }
    nav.nav a:hover { color: var(--text); }

    .nav-actions {
      display: flex; gap: 10px; align-items: center;
    }

    .btn {
      padding: 12px 18px;
      border-radius: 999px;
      border: 1px solid transparent;
      font-weight: 600;
      transition: all 0.25s var(--ease);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      white-space: nowrap;
      font-size: 0.95rem;
      cursor: pointer;
    }
    .btn-primary {
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      color: #0b0f14;
      box-shadow: 0 10px 30px rgba(118,247,210,0.3);
    }
    .btn-primary:hover { transform: translateY(-2px); }
    .btn-ghost {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--text);
    }
    .btn-ghost:hover { border-color: rgba(255,255,255,0.2); background: var(--panel); }
    .btn-secondary {
        background: var(--panel); color: var(--text); border: 1px solid var(--border);
    }
    .btn-secondary:hover { background: var(--panel-2); }
    .btn-danger { background: var(--danger); color: white; border-color: var(--danger); }
    
    .icon-btn {
      width: 40px; height: 40px;
      border-radius: 50%;
      display: grid; place-items: center;
      background: var(--panel);
      border: 1px solid var(--border);
      color: var(--text);
      transition: all 0.2s var(--ease);
    }
    .icon-btn:hover { transform: translateY(-2px); }

    .menu-toggle { font-size: 1.6rem; }

    /* Mobile menu */
    .mobile-menu {
      position: fixed;
      inset: 0;
      background: rgba(10,14,20,0.98);
      z-index: 60;
      padding: 100px 24px 24px;
      display: none;
      overflow-y: auto;
    }
    body.theme-light .mobile-menu { background: rgba(255,255,255,0.98); }
    .mobile-menu.open { display: block; }
    .mobile-menu a {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 0;
      font-size: 1.1rem;
      border-bottom: 1px solid var(--border);
      font-weight: 600;
    }
    .mobile-menu a i { color: var(--brand); }

    /* Pages */
    main { position: relative; z-index: 2; }
    .page { display: none; padding-top: 120px; padding-bottom: 80px; }
    .page.active { display: block; animation: fadeIn 0.4s var(--ease); }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

    /* Reveal */
    .reveal { opacity: 0; transform: translateY(16px); transition: all 0.6s var(--ease); }
    .reveal.visible { opacity: 1; transform: translateY(0); }

    /* Hero */
    .hero {
      display: grid;
      gap: 48px;
      grid-template-columns: 1fr;
      align-items: center;
    }
    .tag {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 14px;
      border-radius: 999px;
      background: rgba(118,247,210,0.12);
      border: 1px solid rgba(118,247,210,0.3);
      color: var(--brand);
      font-size: 0.85rem;
      font-weight: 600;
    }
    .hero h1 {
      font-family: var(--font-display);
      font-size: clamp(2.6rem, 6vw, 5.2rem);
      line-height: 1.04;
      letter-spacing: -0.03em;
      margin: 18px 0;
    }
    .hero p { color: var(--muted); font-size: 1.05rem; max-width: 600px; }
    .hero-cta { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 22px; }

    .hero-panel {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 22px;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }
    .panel-head {
      display: flex; align-items: center; justify-content: space-between;
      margin-bottom: 14px;
    }
    .chip {
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(138,180,255,0.15);
      color: var(--brand-2);
      font-size: 0.75rem;
      border: 1px solid rgba(138,180,255,0.3);
    }

    .wave {
      display: flex; align-items: flex-end; gap: 4px;
      height: 80px; margin: 12px 0 18px;
    }
    .wave span {
      width: 6px;
      height: 40%;
      background: linear-gradient(180deg, var(--brand), var(--brand-2));
      border-radius: 6px;
      animation: wave 1.1s ease-in-out infinite;
      animation-delay: calc(var(--i) * 0.08s);
    }
    @keyframes wave {
      0%,100% { transform: scaleY(0.35); }
      50% { transform: scaleY(1); }
    }

    .panel-metrics {
      display: grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap: 10px;
    }
    .metric {
      background: var(--panel-2);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
      text-align: left;
    }
    .metric h4 { font-family: var(--font-display); font-size: 1.1rem; margin-bottom: 4px; }
    .metric span { color: var(--muted); font-size: 0.85rem; }

    /* Sections */
    .section-title {
      font-family: var(--font-display);
      font-size: clamp(1.6rem, 3.6vw, 2.6rem);
      margin-bottom: 10px;
    }
    .section-sub { color: var(--muted); max-width: 680px; }

    .strip {
      border-top: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
      padding: 16px 0;
      margin: 60px 0;
      overflow: hidden;
      background: rgba(255,255,255,0.02);
    }
    .strip-track {
      display: flex; gap: 32px; width: max-content;
      color: var(--muted); font-weight: 600;
      animation: marquee 28s linear infinite;
    }
    @keyframes marquee { from { transform: translateX(0); } to { transform: translateX(-50%); } }

    /* Grids */
    .grid-3 {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 18px;
    }

    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 22px;
      transition: transform 0.25s var(--ease), box-shadow 0.25s var(--ease);
      position: relative;
    }
    .card:hover { transform: translateY(-6px); box-shadow: var(--shadow); }

    .icon-pill {
      width: 42px; height: 42px;
      border-radius: 12px;
      display: grid; place-items: center;
      background: rgba(118,247,210,0.12);
      color: var(--brand);
      border: 1px solid rgba(118,247,210,0.3);
      margin-bottom: 12px;
      font-size: 1.2rem;
    }

    .stats-grid {
      display: grid; gap: 16px;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      margin-top: 22px;
    }
    .stat-card {
      background: var(--panel-2);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 14px;
      text-align: left;
    }
    .stat-number {
      font-family: var(--font-display);
      font-size: 1.6rem;
      margin-bottom: 4px;
    }

    /* Pricing */
    .pricing-toggle {
      display: inline-flex;
      gap: 6px;
      padding: 6px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--panel);
      margin: 18px 0;
    }
    .toggle-btn {
      padding: 8px 14px;
      border-radius: 999px;
      border: none;
      background: transparent;
      color: var(--muted);
      font-weight: 600;
      cursor: pointer;
    }
    .toggle-btn.active {
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      color: #0b0f14;
    }

    .price-card {
      border-radius: var(--radius-lg);
      padding: 24px;
      background: linear-gradient(180deg, var(--panel-2), var(--panel));
      border: 1px solid var(--border);
      position: relative;
      display: flex; flex-direction: column;
    }
    .price-card.featured {
      border-color: rgba(118,247,210,0.45);
      box-shadow: 0 24px 70px rgba(118,247,210,0.18);
    }
    .price {
      font-size: 2.2rem;
      font-family: var(--font-display);
      margin: 10px 0 8px;
    }
    .price span { color: var(--muted); font-size: 0.95rem; }
    .list {
      display: grid;
      gap: 8px;
      color: var(--muted);
      font-size: 0.95rem;
      margin: 12px 0 18px;
      flex-grow: 1;
    }
    .list i { color: var(--brand); }
    .list .danger-i { color: var(--danger); }

    /* Work */
    .work-card img {
      border-radius: 14px;
      border: 1px solid var(--border);
      margin-bottom: 12px;
      width: 100%; height: 200px; object-fit: cover;
    }

    /* Reviews slider */
    .review-slider {
      position: relative;
      min-height: 220px;
      margin-top: 20px;
    }
    .review-slide {
      position: absolute;
      inset: 0;
      opacity: 0;
      transform: translateY(8px);
      transition: all 0.5s var(--ease);
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
    }
    .review-slide.active {
      opacity: 1;
      transform: translateY(0);
    }
    .stars { color: var(--brand-3); letter-spacing: 2px; }
    .dots {
      display: flex; gap: 8px; margin-top: 12px;
    }
    .dot {
      width: 8px; height: 8px; border-radius: 50%;
      background: var(--border);
      cursor: pointer;
    }
    .dot.active { background: var(--brand); }

    /* FAQ */
    .faq-item {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 14px;
      margin-bottom: 10px;
      overflow: hidden;
    }
    .faq-q {
      padding: 16px;
      display: flex; justify-content: space-between; align-items: center;
      cursor: pointer; font-weight: 600;
    }
    .faq-a {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s var(--ease), padding 0.3s var(--ease);
      padding: 0 16px;
      color: var(--muted);
    }
    .faq-item.open .faq-a {
      max-height: 500px;
      padding: 0 16px 16px;
    }

    /* Forms (Auth/Checkout/Contact) */
    .form { display: grid; gap: 12px; }
    .form-group { text-align: left; }
    .form-label { display: block; margin-bottom: 6px; font-size: 0.85rem; color: var(--muted); font-weight: 600; }
    .input, .textarea, .form-select {
      width: 100%;
      padding: 14px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--panel);
      color: var(--text);
      font-family: inherit;
      transition: border-color 0.2s;
    }
    .input:focus, .textarea:focus, .form-select:focus {
      outline: none;
      border-color: var(--brand);
    }
    .textarea { min-height: 120px; resize: vertical; }
    
    /* Radio Groups (Checkout) */
    .radio-group { display: grid; gap: 10px; }
    .radio-option {
      border: 1px solid var(--border);
      padding: 12px 14px;
      border-radius: 12px;
      display: flex; align-items: center; gap: 10px;
      cursor: pointer; background: var(--panel); transition: all 0.2s;
    }
    .radio-option:hover { border-color: var(--muted); }
    .radio-option.selected { border-color: var(--brand); background: rgba(118, 247, 210, 0.05); }
    .radio-option input { display: none; }

    /* Auth Links */
    .auth-link { color: var(--brand); cursor: pointer; font-weight: 700; text-decoration: underline; }
    
    /* History Table */
    .history-table-container { margin-top: 2rem; width: 100%; overflow-x: auto; border: 1px solid var(--border); border-radius: 12px; background: var(--panel); }
    .history-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
    .history-table th { background: var(--panel-2); color: var(--muted); padding: 1rem; font-weight: 700; text-transform: uppercase; font-size: 0.75rem; border-bottom: 1px solid var(--border); text-align: left; }
    .history-table td { padding: 1rem; border-bottom: 1px solid var(--border); }
    .status-badge { padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; }
    .status-pending { background: rgba(255, 215, 0, 0.1); color: #ffd700; }
    .status-completed { background: rgba(16, 185, 129, 0.1); color: var(--success); }
    .status-paid { background: rgba(118, 247, 210, 0.1); color: var(--brand); }

    /* Toast */
    .toast-wrap {
      position: fixed;
      right: 18px; bottom: 18px;
      display: grid; gap: 10px;
      z-index: 120;
    }
    .toast {
      background: var(--panel-2);
      border: 1px solid var(--border);
      padding: 12px 14px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      display: flex; align-items: center; gap: 10px;
      animation: slideIn 0.3s ease-out;
    }
    .toast.success { border-left: 3px solid var(--success); }
    .toast.error { border-left: 3px solid var(--danger); }
    
    @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

    /* Footer */
    footer {
      border-top: 1px solid var(--border);
      padding: 44px 0 24px;
      color: var(--muted);
      position: relative; z-index: 2;
    }

    /* Processing Overlay */
    #processing-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(10,14,20,0.95);
      z-index: 100002; display: none; flex-direction: column;
      justify-content: center; align-items: center; text-align: center; padding: 2rem;
    }
    .process-spinner {
      width: 60px; height: 60px;
      border: 4px solid var(--border);
      border-left-color: var(--brand);
      border-radius: 50%;
      animation: spin 1s linear infinite; margin-bottom: 2rem;
    }
    @keyframes spin { 100% { transform: rotate(360deg); } }

    /* Responsive */
    @media (min-width: 960px) {
      nav.nav { display: flex; }
      .menu-toggle { display: none; }
      .hero { grid-template-columns: 1.2fr 0.8fr; }
    }
    @media (max-width: 640px) {
      header { padding: 0 12px; }
      .nav-actions .btn-ghost { display: none; }
      .review-slider { height: 260px; }
      .grid-3 { grid-template-columns: 1fr; }
    }

    @media (prefers-reduced-motion: reduce) {
      * { animation: none !important; transition: none !important; }
    }
  </style>
</head>
<body>
  <div class="bg-grid"></div>
  <div class="orb one"></div>
  <div class="orb two"></div>
  <div class="orb three"></div>
  <div class="progress" id="progress"></div>

  <!-- Header -->
  <header id="siteHeader">
    <a href="/" class="logo" data-link>
      <img src="https://raw.githubusercontent.com/ddnetwork-one/ddnetwork-store/refs/heads/main/crop_ddnlogo.png" alt="DDNetwork One logo">
      DDNetwork One
    </a>

    <nav class="nav" id="mainNav">
      <!-- Links handled by JS to include Auth states -->
    </nav>

    <div class="nav-actions">
      <button class="icon-btn" id="themeToggle" aria-pressed="false" title="Toggle theme">
        <i class="ri-sun-line"></i>
      </button>
      <div id="authActions">
          <!-- Injected by JS -->
      </div>
      <div class="menu-toggle" id="menuToggle"><i class="ri-menu-4-line"></i></div>
    </div>
  </header>

  <!-- Mobile Menu -->
  <div class="mobile-menu" id="mobileMenu">
    <!-- Injected by JS -->
  </div>

  <!-- Processing Overlay -->
  <div id="processing-overlay">
    <div class="process-spinner"></div>
    <div id="process-message" style="font-size: 1.2rem; color: var(--text);">Processing...</div>
    <div style="margin-top: 1.5rem; padding: 1rem 1.5rem; border-radius: 12px; color: var(--muted); font-size: 0.9rem; max-width: 300px;">
      If payment was completed, please check your email or click 'I have made payment' on the checkout page.
    </div>
  </div>

  <!-- Main App Container -->
  <main id="app">
    
    <!-- ==================== HOME ==================== -->
    <section class="page active" data-route="/" data-title="DDNetwork One — Premium Web Systems">
      <div class="container hero">
        <div class="reveal visible">
          <span class="tag"><i class="ri-sparkling-2-fill"></i> Malaysia‑built, global‑ready</span>
          <h1>Premium websites, portals, and AI experiences that feel modern and perform fast.</h1>
          <p>DDNetwork One helps ambitious teams build conversion‑ready web experiences with clean design, measurable performance, and scalable systems.</p>
          <div class="hero-cta">
            <a href="/pricing" class="btn btn-primary" data-link>Explore Packages</a>
            <a href="/work" class="btn btn-ghost" data-link>See Recent Work</a>
          </div>

          <div class="stats-grid reveal visible" style="margin-top:22px;">
            <div class="stat-card">
              <div class="stat-number" data-count="10">0</div>
              <div class="section-sub">Successful launches</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" data-count="2.5">0</div>
              <div class="section-sub">Average weeks delivery</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" data-count="98">0</div>
              <div class="section-sub">Client satisfaction %</div>
            </div>
          </div>
        </div>

        <div class="hero-panel reveal visible">
          <div class="panel-head">
            <strong style="font-family:var(--font-display);">DDN Studio Preview</strong>
            <span class="chip">Live UI system</span>
          </div>
          <div style="color:var(--muted); font-size:0.95rem);">
            Motion‑first, product‑grade UI with conversion‑optimized layout.
          </div>
          <div class="wave">
            <span style="--i:1"></span><span style="--i:2"></span><span style="--i:3"></span>
            <span style="--i:4"></span><span style="--i:5"></span><span style="--i:6"></span>
            <span style="--i:7"></span><span style="--i:8"></span><span style="--i:9"></span>
            <span style="--i:10"></span><span style="--i:11"></span><span style="--i:12"></span>
          </div>
          <div class="panel-metrics">
            <div class="metric"><h4>5.0</h4><span>Avg. rating</span></div>
            <div class="metric"><h4>24h</h4><span>Response time</span></div>
            <div class="metric"><h4>SEO</h4><span>Baseline ready</span></div>
          </div>
        </div>
      </div>

      <div class="strip">
        <div class="container">
          <div class="strip-track">
            <span>Secure payments</span> <span>Mobile‑first</span> <span>Fast delivery</span>
            <span>SEO ready</span> <span>AI automation</span> <span>Custom portals</span>
            <span>Secure payments</span> <span>Mobile‑first</span> <span>Fast delivery</span>
            <span>SEO ready</span> <span>AI automation</span> <span>Custom portals</span>
          </div>
        </div>
      </div>

      <section class="container" style="margin-top:-10px;">
        <h2 class="section-title reveal visible">What we build</h2>
        <p class="section-sub reveal visible">Clear, modern experiences that make your business feel premium.</p>
        <div class="grid-3" style="margin-top:20px;">
          <div class="card reveal visible">
            <div class="icon-pill"><i class="ri-layout-4-line"></i></div>
            <h3>Static Websites</h3>
            <p>Fast, elegant landing pages and product sites that load instantly.</p>
          </div>
          <div class="card reveal visible">
            <div class="icon-pill"><i class="ri-layout-masonry-line"></i></div>
            <h3>Interactive Front‑End</h3>
            <p>Animated, story‑driven UI for richer engagement and higher conversion.</p>
          </div>
          <div class="card reveal visible">
            <div class="icon-pill"><i class="ri-robot-2-line"></i></div>
            <h3>AI‑Powered Systems</h3>
            <p>Chatbots, workflows, and automation that save time and cost.</p>
          </div>
        </div>
      </section>
    </section>

    <!-- ==================== PRICING (Services) ==================== -->
    <section class="page" data-route="/pricing" data-title="Pricing — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">Pricing Packages</h2>
        <p class="section-sub reveal">Transparent pricing. Choose plan that fits your needs.</p>

        <div class="pricing-toggle reveal">
          <button class="toggle-btn active" data-billing="monthly">Monthly</button>
          <button class="toggle-btn" data-billing="onetime">One‑Time</button>
        </div>

        <div class="grid-3">
          <!-- Package 1: Basic HTML -->
          <div class="price-card reveal">
            <h3>Basic HTML</h3>
            <div class="price" data-price="html">RM 39 <span>/month</span></div>
            <p style="font-size:0.9rem; color:var(--muted); margin-bottom:12px;">1 Static Landing Page.</p>
            <div id="price-html-setup" class="chip" style="margin-bottom:12px; display:none;">Setup: RM 100</div>
            <div class="list">
              <div><i class="ri-check-line"></i> 1 Landing Page</div>
              <div><i class="ri-check-line"></i> Mobile Responsive</div>
              <div><i class="ri-check-line"></i> Basic SEO</div>
              <div><i class="ri-check-line"></i> Contact Form</div>
              <div><i class="ri-check-line"></i> Free ddnet.my subdomain (1 yr)</div>
              <div id="feat-html-maint" class="hidden"><i class="ri-check-line"></i> Maintenance included</div>
              <div id="feat-html-nosupport" class="hidden"><i class="ri-close-line danger-i"></i> No maintenance</div>
            </div>
            <button class="btn btn-ghost" style="width:100%;" onclick="attemptSelectPackage('Basic HTML Website', 'html')">Select</button>
          </div>

          <!-- Package 2: Front-End (Featured) -->
          <div class="price-card featured reveal">
            <span class="chip" style="position:absolute; top:16px; right:16px; border-color:var(--brand);">Popular</span>
            <h3>Front‑End Website</h3>
            <div class="price" data-price="frontend">RM 99 <span>/month</span></div>
            <p style="font-size:0.9rem; color:var(--muted); margin-bottom:12px;">Up to 5 Pages.</p>
            <div id="price-frontend-setup" class="chip" style="margin-bottom:12px;">Setup: RM 200</div>
            <div class="list">
              <div><i class="ri-check-line"></i> Up to 5 Pages</div>
              <div><i class="ri-check-line"></i> Interactive UI</div>
              <div><i class="ri-check-line"></i> WhatsApp Integration</div>
              <div><i class="ri-check-line"></i> Hosting Included</div>
              <div><i class="ri-check-line"></i> Free ddnet.my subdomain (1 yr)</div>
              <div id="feat-fe-maint" class="hidden"><i class="ri-check-line"></i> Maintenance included</div>
              <div id="feat-fe-nosupport" class="hidden"><i class="ri-close-line danger-i"></i> No maintenance</div>
            </div>
            <button class="btn btn-primary" style="width:100%;" onclick="attemptSelectPackage('Front-End Website', 'frontend')">Select Front-End</button>
          </div>

          <!-- Package 3: Bundle -->
          <div class="price-card reveal">
             <span class="chip" style="position:absolute; top:16px; right:16px; background:rgba(138,180,255,0.15); border-color:var(--brand-2); color:var(--brand-2);">Best Value</span>
            <h3>Front-End + Portal</h3>
            <div class="price" data-price="bundle">RM 249 <span>/month</span></div>
            <p style="font-size:0.9rem; color:var(--muted); margin-bottom:12px;">Website & Internal Portal.</p>
            <div id="price-bundle-setup" class="chip" style="margin-bottom:12px;">Setup: RM 700</div>
            <div class="list">
              <div><i class="ri-check-line"></i> Everything in Front-End</div>
              <div><i class="ri-check-line"></i> Multi-User Portal</div>
              <div><i class="ri-check-line"></i> Database Management</div>
              <div><i class="ri-check-line"></i> Custom Dashboards</div>
              <div id="feat-bundle-maint" class="hidden"><i class="ri-check-line"></i> Priority Support</div>
              <div id="feat-bundle-nosupport" class="hidden"><i class="ri-close-line danger-i"></i> No maintenance</div>
            </div>
            <button class="btn btn-ghost" style="width:100%;" onclick="attemptSelectPackage('Front-End + Portal', 'bundle')">Select Bundle</button>
          </div>

          <!-- Package 4: AI -->
          <div class="price-card reveal">
            <h3>AI Powered</h3>
            <div class="price" data-price="ai">RM 149 <span>/month</span></div>
            <p style="font-size:0.9rem; color:var(--muted); margin-bottom:12px;">Automation & Chatbots.</p>
            <div id="price-ai-setup" class="chip" style="margin-bottom:12px;">Setup: RM 400</div>
            <div class="list">
              <div><i class="ri-check-line"></i> All Front-End Features</div>
              <div><i class="ri-check-line"></i> AI Chatbot</div>
              <div><i class="ri-check-line"></i> Lead Auto-Response</div>
              <div><i class="ri-check-line"></i> Smart Analytics</div>
              <div id="feat-ai-maint" class="hidden"><i class="ri-check-line"></i> AI Tuning Included</div>
              <div id="feat-ai-nosupport" class="hidden"><i class="ri-close-line danger-i"></i> No support</div>
            </div>
            <button class="btn btn-ghost" style="width:100%;" onclick="openQuoteForm('AI Powered Website')">Request Quote</button>
          </div>

          <!-- Package 5: Portal Standalone -->
          <div class="price-card reveal">
            <h3>Portal Standalone</h3>
            <div class="price" data-price="portal">RM 279 <span>/month</span></div>
            <p style="font-size:0.9rem; color:var(--muted); margin-bottom:12px;">Internal Systems.</p>
            <div id="price-portal-setup" class="chip" style="margin-bottom:12px;">Setup: RM 700</div>
            <div class="list">
              <div><i class="ri-check-line"></i> Multi-User Portal</div>
              <div><i class="ri-check-line"></i> Database System</div>
              <div><i class="ri-check-line"></i> Business Integration</div>
              <div id="feat-portal-maint" class="hidden"><i class="ri-check-line"></i> Enterprise Support</div>
              <div id="feat-portal-nosupport" class="hidden"><i class="ri-close-line danger-i"></i> No support</div>
            </div>
            <button class="btn btn-ghost" style="width:100%;" onclick="openQuoteForm('Portal Standalone')">Request Quote</button>
          </div>

        </div>
      </div>
    </section>

    <!-- ==================== CHECKOUT (BuyNow) ==================== -->
    <section class="page" data-route="/checkout" data-title="Checkout — DDNetwork One">
      <div class="container">
        <div style="text-align:center; margin-bottom: 2rem;">
            <h2 class="section-title reveal">Finalize Order</h2>
            <p class="section-sub reveal">Secure your package and configuration.</p>
        </div>

        <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap:2rem;">
            <!-- Left: Summary -->
            <div class="card reveal" style="height:fit-content;">
                <div style="display:flex; justify-content:space-between; margin-bottom:1rem; padding-bottom:1rem; border-bottom:1px solid var(--border);">
                    <h3 style="font-family:var(--font-display); font-size:1rem;">Order Summary</h3>
                    <a href="/pricing" class="auth-link" data-link>Change</a>
                </div>
                
                <div style="background:var(--panel); padding:1.2rem; border-radius:12px; margin-bottom:1.5rem;">
                    <h4 id="summary-pkg-name" style="color:var(--brand); margin-bottom:0.5rem;">Select a Package</h4>
                    <p id="summary-pkg-desc" style="font-size:0.9rem; color:var(--muted);">Please select a package.</p>
                    <div id="dynamic-price-area" style="margin-top:8px;"></div>
                </div>

                <div style="display:grid; gap:0.8rem; margin-bottom:1.5rem;">
                    <div style="display:flex; justify-content:space-between;"><span color:var(--muted);>Setup Fee:</span> <strong id="summary-setup">RM 0</strong></div>
                    <div style="display:flex; justify-content:space-between;"><span color:var(--muted);>Recurring:</span> <strong id="summary-recurring">RM 0</strong></div>
                    <div style="display:flex; justify-content:space-between;"><span color:var(--muted);>Domain:</span> <strong id="summary-domain">Free (1st Year)</strong></div>
                    <div style="display:flex; justify-content:space-between;"><span color:var(--muted);>Maintenance:</span> <strong id="summary-maintenance">None</strong></div>
                    
                    <div id="row-discount" style="display:none; justify-content:space-between; color:var(--success);">
                        <span>Discount: <strong id="summary-promo-code"></strong></span>
                        <span id="summary-discount-val">-RM 0</span>
                    </div>
                </div>

                <div style="display:flex; justify-content:space-between; font-size:1.4rem; font-weight:700; border-top:1px solid var(--border); padding-top:16px;">
                    <span>Total</span> <span id="summary-final-total" style="color:var(--brand);">RM 0</span>
                </div>
                
                <div id="deposit-note" style="text-align:right; font-size:0.8rem; color:var(--brand-3); margin-top:8px; display:none;">
                    Deposit (50%): RM 0
                </div>
                 <div class="payment-options" style="display: flex; gap: 10px; justify-content: flex-end; margin-top:10px;">
                    <button type="button" class="btn btn-ghost" style="padding: 0.5rem 1rem; font-size: 0.8rem;" id="btn-pay-full" onclick="setPaymentMode('full')">Pay Full</button>
                    <button type="button" class="btn btn-secondary" style="padding: 0.5rem 1rem; font-size: 0.8rem;" id="btn-pay-deposit" onclick="setPaymentMode('deposit')">Pay Deposit</button>
                </div>
            </div>

            <!-- Right: Config -->
            <div class="card reveal">
                <h3 style="margin-bottom:1.5rem;">Configuration</h3>
                <form id="checkoutForm" class="form">
                    <div class="form-group">
                        <label class="form-label">Personal Details</label>
                        <div style="display:grid; gap:10px;">
                            <input type="text" id="co-name" class="input" placeholder="Full Name" required>
                            <input type="tel" id="co-phone" class="input" placeholder="Phone Number" required>
                            <input type="email" id="co-email" class="input" placeholder="Email Address" required>
                            <input type="text" id="co-company" class="input" placeholder="Company (Optional)">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Domain Choice</label>
                        <div class="radio-group">
                            <div class="radio-option selected" onclick="updateDomain('sub', this)">
                                <input type="radio" name="domain_type" value="sub" checked> 
                                <span>DDNetwork Subdomain (Free)</span>
                            </div>
                            <div class="radio-option" onclick="updateDomain('custom', this)">
                                <input type="radio" name="domain_type" value="custom"> 
                                <span>I have my own domain</span>
                            </div>
                        </div>
                        <div id="input-subdomain" style="margin-top:10px;">
                            <input type="text" id="subdomain-text" class="input" placeholder="yourname">
                            <span style="font-size:0.8rem; color:var(--muted);">.ddnet.my</span>
                        </div>
                        <div id="input-custom" style="display:none; margin-top:10px;">
                            <input type="text" id="custom-domain-text" class="input" placeholder="www.example.com">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Maintenance Plan</label>
                        <div class="radio-group">
                            <div class="radio-option selected" onclick="updateMaintenance('none', this)"><input type="radio" name="maint" checked> None</div>
                            <div class="radio-option" onclick="updateMaintenance('basic', this)"><input type="radio" name="maint"> Basic (+RM 50/mo)</div>
                            <div class="radio-option" onclick="updateMaintenance('business', this)"><input type="radio" name="maint"> Business (+RM 100/mo)</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Promo Code (Optional)</label>
                        <div style="display:flex; gap:10px;">
                            <input type="text" id="promo-input" class="input" placeholder="PROMO10%">
                            <button type="button" class="btn btn-ghost" onclick="applyPromo()">Apply</button>
                        </div>
                    </div>

                    <div class="form-group" style="background:var(--panel); padding:1rem; border-radius:12px; border:1px solid var(--border);">
                        <label style="display:flex; align-items:center; gap:10px; cursor:pointer;">
                            <input type="checkbox" id="terms-check" style="accent-color: var(--brand);">
                            <span style="font-size:0.9rem; color:var(--muted);">I agree to <a href="/terms" data-link class="auth-link">Terms</a></span>
                        </label>
                    </div>

                    <div id="checkout-actions" style="margin-top:1rem;">
                        <button type="button" id="btn-pay-now" class="btn btn-primary" style="width:100%;" onclick="initiateRazorpayPayment()"><i class="ri-credit-card-2-fill"></i> Pay Now</button>
                    </div>

                    <div id="manual-confirm-section" style="display:none; margin-top:1.5rem; text-align:center;">
                        <i class="ri-checkbox-circle-fill" style="font-size:3rem; color:var(--success);"></i>
                        <h3 style="margin:0.5rem 0;">Payment Window Opened</h3>
                        <p style="font-size:0.9rem; color:var(--muted); margin-bottom:1rem;">Complete payment in the window. Click below once done.</p>
                        <button type="button" class="btn btn-primary" style="width:100%;" onclick="handleManualConfirmation()">I have made payment</button>
                    </div>
                </form>
            </div>
        </div>
      </div>
    </section>

    <!-- ==================== REVIEWS ==================== -->
    <section class="page" data-route="/reviews" data-title="Reviews — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">Client Reviews</h2>
        <p class="section-sub reveal">See what our clients say about us.</p>

        <!-- Review Form -->
        <div class="card reveal" style="max-width:700px; margin:2rem auto;">
            <h3 style="margin-bottom:1rem;">Write a Review</h3>
            <form id="review-form" class="form" onsubmit="handleReviewSubmit(event)">
                 <div class="form-group">
                    <label class="form-label">Rating</label>
                    <div style="display:flex; gap:4px; font-size:1.5rem; cursor:pointer;" id="star-input-container">
                        <i class="ri-star-fill star-icon" data-val="1"></i>
                        <i class="ri-star-fill star-icon" data-val="2"></i>
                        <i class="ri-star-fill star-icon" data-val="3"></i>
                        <i class="ri-star-fill star-icon" data-val="4"></i>
                        <i class="ri-star-fill star-icon" data-val="5"></i>
                    </div>
                    <input type="hidden" id="rating-value" required>
                </div>
                <div class="form-group">
                    <textarea id="review-comment" class="textarea" rows="4" placeholder="Share your experience..." required></textarea>
                </div>
                <button type="submit" class="btn btn-primary" style="width:100%;">Submit Review</button>
            </form>
        </div>

        <!-- Reviews Slider/List -->
        <div class="review-slider reveal" id="reviewSlider">
           <!-- Injected by JS -->
        </div>
        <div class="dots" id="reviewDots"></div>
        
        <div id="reviews-list" class="grid-3" style="margin-top:2rem;">
            <!-- Full list loaded here -->
        </div>
      </div>
    </section>

    <!-- ==================== CLIENTS (Work) ==================== -->
    <section class="page" data-route="/work" data-title="Portfolio — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">Recent Work</h2>
        <p class="section-sub reveal">Trusted by forward-thinking businesses.</p>
        <div id="portfolio-grid" class="grid-3" style="margin-top:20px;">
           <!-- Loaded by JS -->
        </div>
      </div>
    </section>

    <!-- ==================== ABOUT (Company) ==================== -->
    <section class="page" data-route="/about" data-title="About — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">Simplicity in Digital</h2>
        <p class="section-sub reveal">We build digital tools that are clean, fast, and easy to use.</p>
        
        <div class="card reveal" style="max-width:800px; margin:2rem auto; text-align:center;">
            <p style="color:var(--muted); line-height:1.8;">
                <strong style="color:var(--text);">DD Cloud Network</strong> is a registered digital agency based in Malaysia. We operate <strong style="color:var(--brand);">DDNetwork</strong> as a specialized sub-brand focused on delivering modern web solutions.
            </p>
            <p style="color:var(--muted); margin-top:1rem;">
                Founded by <strong style="color:var(--text);">Danial Danish</strong>, our team partners with startups, local businesses, and individuals to turn ideas into reality.
            </p>
        </div>

        <div class="grid-3" style="margin-top:20px;">
          <div class="card reveal">
            <div class="icon-pill"><i class="ri-eye-2-line"></i></div>
            <h3>Our Vision</h3>
            <p>To build a digital ecosystem where technology serves people, not the other way around.</p>
          </div>
          <div class="card reveal">
            <div class="icon-pill"><i class="ri-team-line"></i></div>
            <h3>Our Approach</h3>
            <p>We prioritize speed, clean design, and smart functionality.</p>
          </div>
          <div class="card reveal">
            <div class="icon-pill"><i class="ri-map-pin-line"></i></div>
            <h3>Location</h3>
            <p>Designed in Malaysia. Built for the world.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- ==================== FOUNDER ==================== -->
    <section class="page" data-route="/founder" data-title="Founder — DDNetwork One">
        <div class="container" style="text-align:center;">
            <div class="card reveal" style="max-width:600px; margin:0 auto; padding:3rem;">
                <img src="https://raw.githubusercontent.com/ddnetwork-ent/DDN-One/refs/heads/main/DD.JPG" alt="Danial Danish" style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 4px solid var(--border); margin-bottom: 1.5rem;">
                <h2>Danial Danish</h2>
                <p style="color:var(--brand); font-weight:700; letter-spacing:1px; text-transform:uppercase; font-size:0.8rem; margin-bottom:1.5rem;">Founder & Lead Developer</p>
                <p style="color:var(--muted); line-height:1.7;">
                    "My journey began with a curiosity for code. What started as late-night experiments grew into DD Cloud Network, a company built on simplicity, speed, and thoughtful digital design."
                </p>
                <div style="display:flex; gap:1rem; justify-content:center; margin-top:1.5rem;">
                    <a href="https://www.linkedin.com/in/muhammad-danial-danish-217bb82ba/" target="_blank" class="icon-btn"><i class="ri-linkedin-fill"></i></a>
                    <a href="https://www.instagram.com/danialddanish/" target="_blank" class="icon-btn"><i class="ri-instagram-line"></i></a>
                </div>
            </div>
        </div>
    </section>

    <!-- ==================== FAQ ==================== -->
    <section class="page" data-route="/faq" data-title="FAQ — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">Frequently Asked Questions</h2>
        <p class="section-sub reveal">Everything you need to know about our services.</p>

        <div style="margin-top:16px; max-width:800px; margin-left:auto; margin-right:auto;">
          <div class="faq-item reveal">
            <div class="faq-q">How long does it take to build a website? <i class="ri-arrow-down-s-line"></i></div>
            <div class="faq-a">Simple HTML static websites typically take 3-5 working days. Complex interactive sites or AI integrations take 2 to 4 weeks.</div>
          </div>
          <div class="faq-item reveal">
            <div class="faq-q">Do I need to pay for hosting and domain? <i class="ri-arrow-down-s-line"></i></div>
            <div class="faq-a">Yes, all websites require a domain. We offer free hosting for the first year with selected packages. Domain costs vary by extension.</div>
          </div>
          <div class="faq-item reveal">
            <div class="faq-q">Can I update the website content myself? <i class="ri-arrow-down-s-line"></i></div>
            <div class="faq-a">For Portal solutions, yes. For static HTML sites, minor updates might require our assistance, though we can integrate a CMS upon request.</div>
          </div>
          <div class="faq-item reveal">
            <div class="faq-q">What payment methods do you accept? <i class="ri-arrow-down-s-line"></i></div>
            <div class="faq-a">We accept Razorpay (via Curlec), FPX, credit/debit cards, and e-wallets.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- ==================== HELPDESK ==================== -->
    <section class="page" data-route="/helpdesk" data-title="Helpdesk — DDNetwork One">
        <div class="container">
            <div class="card reveal" style="max-width:800px; margin:0 auto;">
                <div style="text-align:center; margin-bottom:2rem;">
                    <i class="ri-customer-service-2-fill" style="font-size:3rem; color:var(--brand);"></i>
                    <h2>Helpdesk</h2>
                    <p style="color:var(--muted);">Submit a support ticket. We'll get back to you ASAP.</p>
                </div>

                <form id="ticket-form" class="form" onsubmit="handleTicketSubmit(event)">
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                        <input type="text" id="ticket-name" class="input" placeholder="Full Name" required>
                        <input type="email" id="ticket-email" class="input" placeholder="Email Address" required>
                    </div>
                    <select id="ticket-type" class="input" required>
                        <option value="" disabled selected>Select Issue Type</option>
                        <option value="Cannot login">Cannot login</option>
                        <option value="Payment issue">Payment issue</option>
                        <option value="Website not loading">Website not loading</option>
                        <option value="Other issue">Other issue</option>
                    </select>
                    <textarea id="ticket-message" class="textarea" placeholder="Describe your issue..." required></textarea>
                    <button type="submit" class="btn btn-primary" style="width:100%;">Submit Ticket</button>
                </form>
                
                <div id="case-id-display" style="display:none; margin-top:1.5rem; padding:1.5rem; border:1px solid var(--success); background:rgba(16,185,129,0.05); border-radius:12px; text-align:center;">
                    <div style="font-size:0.85rem; color:var(--success); font-weight:700; margin-bottom:0.5rem;">TICKET SUBMITTED</div>
                    <div id="display-case-id" style="font-size:1.5rem; font-weight:800; color:var(--text); font-family:monospace;">#Ticket-0000</div>
                </div>

                <div style="margin-top:2rem; border-top:1px solid var(--border); padding-top:2rem;">
                    <h3 style="font-size:1.1rem; margin-bottom:1rem;">Check Ticket Status</h3>
                    <div style="display:flex; gap:10px;">
                        <input type="text" id="history-search-id" class="input" placeholder="Enter Case ID (#Ticket-0001)">
                        <button type="button" class="btn btn-ghost" onclick="fetchTicketHistory()">Search</button>
                    </div>
                    <div id="ticket-list" style="margin-top:1rem;"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- ==================== CONTACT ==================== -->
    <section class="page" data-route="/contact" data-title="Contact — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">Let’s Talk</h2>
        <p class="section-sub reveal">Tell us about your project and we’ll respond within 24 hours.</p>

        <div class="card reveal" style="max-width:700px; margin:1.5rem auto 0;">
          <form id="contactForm" class="form" onsubmit="handleContactSubmit(event)">
            <div style="display:grid; gap:12px; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));">
              <input class="input" type="text" name="name" placeholder="Full Name" required>
              <input class="input" type="email" name="email" placeholder="Email Address" required>
            </div>
            <textarea class="textarea" name="message" placeholder="Tell us about your project..." required></textarea>
            <button type="submit" class="btn btn-primary">Send Message</button>
          </form>
          <div style="margin-top:14px; color:var(--muted); text-align:center;">
            Email: <strong style="color:var(--brand);">sales@ddnet.my</strong>
          </div>
        </div>
      </div>
    </section>

    <!-- ==================== TERMS ==================== -->
    <section class="page" data-route="/terms" data-title="Terms — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">Terms & Conditions</h2>
        <p class="section-sub reveal">By accessing or using services, you agree to be legally bound by these Terms.</p>
        <div class="card reveal" style="margin-top:18px; max-width:800px; margin-left:auto; margin-right:auto;">
          <p style="color:var(--muted); margin-bottom:12px;"><strong>Hosting:</strong> Provided based on customer’s own custom domain. Free ddnet.my subdomain included for the first year.</p>
          <p style="color:var(--muted); margin-bottom:12px;"><strong>Scope:</strong> Work includes only what is explicitly stated in selected package.</p>
          <p style="color:var(--muted); margin-bottom:12px;"><strong>Payments:</strong> Setup fees are non‑refundable. Subscriptions are billed in advance.</p>
          <p style="color:var(--muted); margin-bottom:12px;"><strong>Delivery:</strong> Timelines depend on feedback and content readiness.</p>
          <p style="color:var(--muted);"><strong>Ownership:</strong> Full ownership transfers after final payment.</p>
        </div>
      </div>
    </section>

    <!-- ==================== PRIVACY ==================== -->
    <section class="page" data-route="/privacy" data-title="Privacy — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">Privacy Policy</h2>
        <p class="section-sub reveal">We respect your privacy and protect your data.</p>
        <div class="card reveal" style="margin-top:18px; max-width:800px; margin-left:auto; margin-right:auto;">
          <p style="color:var(--muted); margin-bottom:12px;">We collect only the information required to deliver services and communicate with you.</p>
          <p style="color:var(--muted); margin-bottom:12px;">We do not sell or trade personal data.</p>
          <p style="color:var(--muted);">You can request updates or deletion of your data by contacting support.</p>
        </div>
      </div>
    </section>

    <!-- ==================== LOGIN ==================== -->
    <section class="page" data-route="/login" data-title="Login — DDNetwork One">
      <div class="container">
        <div class="card reveal" style="max-width:450px; margin:0 auto; text-align:center;">
            <i class="ri-user-3-fill" style="font-size:3rem; color:var(--brand); margin-bottom:1rem;"></i>
            <h2>Welcome Back</h2>
            <p style="color:var(--muted); margin-bottom:2rem;">Login to manage your orders.</p>
            
            <form id="login-form" class="form" onsubmit="handleLogin(event)">
                <input type="email" id="login-email" class="input" placeholder="Email Address" required>
                <input type="password" id="login-password" class="input" placeholder="Password" required>
                <button type="submit" class="btn btn-primary" style="width:100%;">Login</button>
            </form>
            
            <div style="margin:1.5rem 0; display:flex; align-items:center; gap:10px;">
                <div style="height:1px; background:var(--border); flex:1;"></div>
                <span style="color:var(--muted); font-size:0.8rem; text-transform:uppercase;">Or</span>
                <div style="height:1px; background:var(--border); flex:1;"></div>
            </div>

            <button type="button" class="btn btn-secondary" style="width:100%;" onclick="handleGoogleAuth()">
                <i class="ri-google-fill" style="color:#DB4437;"></i> Continue with Google
            </button>
            
            <div style="margin-top:1.5rem; font-size:0.9rem; color:var(--muted);">
                Don't have an account? <span class="auth-link" onclick="navigateTo('/signup')">Sign Up</span>
            </div>
        </div>
      </div>
    </section>

    <!-- ==================== SIGNUP ==================== -->
    <section class="page" data-route="/signup" data-title="Sign Up — DDNetwork One">
      <div class="container">
        <div class="card reveal" style="max-width:450px; margin:0 auto; text-align:center;">
            <h2>Create Account</h2>
            <p style="color:var(--muted); margin-bottom:2rem;">Join us to track your projects.</p>
            
            <form id="signup-form" class="form" onsubmit="handleSignup(event)">
                <input type="text" id="signup-name" class="input" placeholder="Full Name" required>
                <input type="tel" id="signup-phone" class="input" placeholder="Phone Number" required>
                <input type="email" id="signup-email" class="input" placeholder="Email Address" required>
                <input type="password" id="signup-password" class="input" placeholder="Create Password" required>
                <button type="submit" class="btn btn-primary" style="width:100%;">Create Account</button>
            </form>
            
            <div style="margin-top:1.5rem; font-size:0.9rem; color:var(--muted);">
                Already have an account? <span class="auth-link" onclick="navigateTo('/login')">Login</span>
            </div>
        </div>
      </div>
    </section>

    <!-- ==================== PROFILE ==================== -->
    <section class="page" data-route="/profile" data-title="Profile — DDNetwork One">
      <div class="container">
        <div class="card reveal" style="max-width:900px; margin:0 auto;">
            <div style="text-align:center; margin-bottom:2rem;">
                <i class="ri-user-settings-fill" style="font-size:3rem; color:var(--brand);"></i>
                <h2>My Profile</h2>
                <p style="color:var(--muted);">View and update your personal details.</p>
            </div>
            
            <form onsubmit="handleProfileUpdate(event)">
                <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:1rem;">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" id="prof-name" class="input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" id="prof-email" class="input" readonly style="opacity:0.7;">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Phone Number</label>
                        <input type="tel" id="prof-phone" class="input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Company (Optional)</label>
                        <input type="text" id="prof-company" class="input">
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="width:100%;">Update Profile</button>
            </form>
            
            <div id="profile-voucher-section" style="display:none; margin-top:2rem; border-top:1px solid var(--border); padding-top:2rem;">
                <!-- Voucher injected by JS -->
            </div>

            <div style="margin-top:2rem; border-top:1px solid var(--border); padding-top:2rem; text-align:center;">
                 <button type="button" class="btn btn-secondary" onclick="handleProfileReset()"><i class="ri-lock-password-fill"></i> Reset Password</button>
            </div>

            <div id="profile-history-section" style="margin-top:2rem; display:none;">
                <h3 style="font-size:1.2rem; margin-bottom:1rem;">Purchase History</h3>
                <div class="history-table-container">
                    <table class="history-table">
                        <thead><tr><th>Date</th><th>Package</th><th>Total</th><th>Status</th></tr></thead>
                        <tbody id="order-history-body"></tbody>
                    </table>
                </div>
            </div>
        </div>
      </div>
    </section>

    <!-- ==================== UPDATES (Customer Requests) ==================== -->
    <section class="page" data-route="/updates" data-title="Updates — DDNetwork One">
        <div class="container">
            <div class="card reveal" style="max-width:800px; margin:0 auto;">
                <div style="text-align:center; margin-bottom:2rem;">
                    <i class="ri-edit-circle-fill" style="font-size:3rem; color:var(--brand);"></i>
                    <h2>Customer Requests</h2>
                    <p style="color:var(--muted);">Need to update content, upgrade, or renew? Submit here.</p>
                </div>
                <form onsubmit="handleRequestSubmit(event)" class="form">
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                        <input type="text" id="req-name" class="input" placeholder="Full Name" required>
                        <input type="tel" id="req-phone" class="input" placeholder="Phone Number" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Request Type</label>
                        <div class="radio-group">
                            <div class="radio-option selected" onclick="handleUpdateTypeChange('content', this)"><input type="radio" name="req_type" checked> Update Content</div>
                            <div class="radio-option" onclick="handleUpdateTypeChange('upgrade', this)"><input type="radio" name="req_type"> Upgrade Plan</div>
                            <div class="radio-option" onclick="handleUpdateTypeChange('renew', this)"><input type="radio" name="req_type"> Renew Plan</div>
                        </div>
                    </div>

                    <div id="field-content">
                        <textarea id="req-desc-content" class="textarea" placeholder="Describe changes..."></textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" style="width:100%;">Submit Request</button>
                </form>
            </div>
        </div>
    </section>

    <!-- ==================== WEBSITE IDEA ==================== -->
    <section class="page" data-route="/describe-idea" data-title="Describe Idea — DDNetwork One">
        <div class="container">
            <div class="card reveal" style="max-width:800px; margin:0 auto;">
                <div style="text-align:center; margin-bottom:2rem;">
                    <i class="ri-lightbulb-flash-fill" style="font-size:3rem; color:var(--brand-3);"></i>
                    <h2>Describe Your Website</h2>
                    <p style="color:var(--muted);">Tell us your vision!</p>
                </div>
                <form id="website-idea-form" onsubmit="handleWebsiteIdeaSubmit(event)" class="form">
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                        <input type="text" id="idea-name" class="input" placeholder="Name" required>
                        <input type="tel" id="idea-phone" class="input" placeholder="Phone" required>
                    </div>
                    <input type="email" id="idea-email" class="input" placeholder="Email" required>
                    <select id="idea-type" class="input" required>
                        <option value="" disabled selected>Project Type</option>
                        <option value="New Website">New Website</option>
                        <option value="Redesign">Redesign</option>
                        <option value="Portal">Internal Portal</option>
                    </select>
                    <textarea id="idea-message" class="textarea" rows="6" placeholder="Describe your idea..." required></textarea>
                    <button type="submit" class="btn btn-primary" style="width:100%;">Submit Idea</button>
                </form>
            </div>
        </div>
    </section>

  </main>

  <footer>
    <div class="container" style="display:grid; gap:16px;">
      <div style="display:flex; justify-content:space-between; gap:16px; flex-wrap:wrap;">
        <div>
          <div class="logo" style="margin-bottom:10px;">
            <img src="https://raw.githubusercontent.com/ddnetwork-one/ddnetwork-store/refs/heads/main/crop_ddnlogo.png" alt="DDNetwork One logo">
            DDNetwork One
          </div>
          Designed in Malaysia. Built for the world.
        </div>
        <div style="display:flex; gap:14px; align-items:center;">
          <a href="https://www.linkedin.com/in/muhammad-danial-danish-217bb82ba/" target="_blank" class="icon-btn"><i class="ri-linkedin-fill"></i></a>
          <a href="https://www.instagram.com/ddnet.my/" target="_blank" class="icon-btn"><i class="ri-instagram-line"></i></a>
        </div>
      </div>
      <div style="border-top:1px solid var(--border); padding-top:12px; font-size:0.9rem; text-align:center;">
        © 2025–2026 DD Cloud Network · DDNetwork One · Reg. No. 202603040752 (MA0342542-K)
      </div>
    </div>
  </footer>

  <!-- Success Modal for Idea -->
  <div id="idea-success-modal" style="position:fixed; inset:0; background:rgba(0,0,0,0.8); display:none; justify-content:center; align-items:center; z-index:1000;">
      <div class="card" style="max-width:500px; text-align:center; padding:3rem;">
          <i class="ri-checkbox-circle-fill" style="font-size:4rem; color:var(--success); margin-bottom:1rem;"></i>
          <h2>Request Received!</h2>
          <p style="color:var(--muted); margin:1rem 0;">Thank you! Your request has been successfully saved.</p>
          <button class="btn btn-primary" onclick="closeIdeaSuccessModal()">Back to Home</button>
      </div>
  </div>

  <div class="toast-wrap" id="toastWrap"></div>

  <!-- CHAT WIDGET SCRIPT -->
  <script src="https://app.livechatai.com/embed.js" data-id="cmlas1njr0001jj04hi5ygd18" async defer></script>

  <script>
    // ==========================================
    // CONFIG & STATE
    // ==========================================
    const firebaseConfig = {
        apiKey: "AIzaSyAwf31b-wpYQwPbd-3DxnqGVRw8g3xq938",
        authDomain: "ddnetwork-database.firebaseapp.com",
        projectId: "ddnetwork-database",
        storageBucket: "ddnetwork-database.firebasestorage.app",
        messagingSenderId: "699127560990",
        appId: "1:699127560990:web:vg8k3pcvhkomoeb99tr333960v6ohj5m."
    };
    const RAZORPAY_KEY_ID = "rzp_live_SEL3cH71UlI5YI"; 
    const ADMIN_PHONE_NO = "60122600969"; 
    
    let db, auth;
    let currentUserRole = 'user';
    let currentUserPersonalVoucher = null;
    
    let state = {
        packageType: null, packagePrice: 0, setupFee: 0, domainPrice: 0,
        maintenancePrice: 0, discountRate: 0, discountFixed: 0, discountType: 'percent',
        discountCode: '', domainType: 'sub', domainName: '', domainNameValid: false,
        billingCycle: 'monthly', isOneTime: false, paymentMode: 'full'
    };

    let PRICING_DATA = {
        html: { oneTime: 249, monthly: 39, setupFee: 100, desc: "1 Static Landing Page." },
        frontend: { oneTime: 1399, monthly: 99, setupFee: 200, desc: "Up to 5 Pages." },
        bundle: { oneTime: 3499, monthly: 249, setupFee: 700, desc: "Website & Portal." },
        ai: { oneTime: 2499, monthly: 149, setupFee: 400, desc: "Automation & Chatbots." },
        portal: { oneTime: 3999, monthly: 279, setupFee: 700, desc: "Internal Systems." }
    };
    let PROMO_CODES = {};

    // Initialize Firebase
    try {
        if(firebaseConfig.apiKey !== "YOUR_API_KEY_HERE") {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            auth = firebase.auth();
        }
    } catch(e) { console.error("Firebase init error:", e); }

    // ==========================================
    // UI CORE & ROUTING
    // ==========================================
    const prefersReduced = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
    const pages = Array.from(document.querySelectorAll(".page"));
    const header = document.getElementById("siteHeader");
    const progress = document.getElementById("progress");
    const menuToggle = document.getElementById("menuToggle");
    const mobileMenu = document.getElementById("mobileMenu");
    const themeToggle = document.getElementById("themeToggle");
    const mainNav = document.getElementById("mainNav");
    const authActions = document.getElementById("authActions");

    const routes = {
      "/": "home", "/pricing": "pricing", "/checkout": "checkout",
      "/reviews": "reviews", "/work": "work", "/about": "about",
      "/faq": "faq", "/contact": "contact", "/terms": "terms",
      "/privacy": "privacy", "/login": "login", "/signup": "signup",
      "/profile": "profile", "/helpdesk": "helpdesk", "/founder": "founder",
      "/updates": "updates", "/describe-idea": "describe-idea"
    };

    const useHash = location.protocol === "file:";
    const normalize = (p) => (p.length > 1 && p.endsWith("/") ? p.slice(0, -1) : p);
    
    function getPath() {
      if (useHash) return normalize(location.hash.replace("#", "") || "/");
      return normalize(location.pathname);
    }

    function render(path, replace = false) {
      const route = routes[path] ? path : "/";
      const page = document.querySelector(`.page[data-route="${route}"]`);
      pages.forEach(p => p.classList.remove("active"));
      if (page) page.classList.add("active");
      document.title = page?.dataset.title || "DDNetwork One";

      // Update Nav Active State
      mainNav.querySelectorAll('a').forEach(a => a.classList.toggle("active", a.getAttribute("href") === route));
      mobileMenu.querySelectorAll('a').forEach(a => a.classList.toggle("active", a.getAttribute("href") === route));
      mobileMenu.classList.remove("open");

      if (!prefersReduced) window.scrollTo({ top: 0, behavior: "smooth" });
      else window.scrollTo(0, 0);

      setupReveal();
      setupCounters();
      if (route === "/reviews") startReviews(); else stopReviews();
      
      if (!useHash) {
        if (replace) history.replaceState({ path: route }, "", route);
        else history.pushState({ path: route }, "", route);
      }
    }

    function navigateTo(path) {
        if (useHash) location.hash = path;
        else render(path);
    }
    window.navigateTo = navigateTo; // Expose globally

    document.querySelectorAll("[data-link]").forEach(link => {
      link.addEventListener("click", (e) => {
        const href = link.getAttribute("href");
        if (!href || href.startsWith("http")) return;
        e.preventDefault();
        navigateTo(href);
      });
    });

    window.addEventListener(useHash ? "hashchange" : "popstate", () => {
      render(getPath(), true);
    });

    menuToggle?.addEventListener("click", () => mobileMenu.classList.toggle("open"));

    themeToggle?.addEventListener("click", () => {
      const isLight = document.body.classList.toggle("theme-light");
      themeToggle.innerHTML = isLight ? '<i class="ri-moon-line"></i>' : '<i class="ri-sun-line"></i>';
      localStorage.setItem("ddn-theme", isLight ? "light" : "dark");
    });
    if (localStorage.getItem("ddn-theme") === "light") {
      document.body.classList.add("theme-light");
      themeToggle.innerHTML = '<i class="ri-moon-line"></i>';
    }

    function updateProgress() {
      const h = document.documentElement.scrollHeight - window.innerHeight;
      const ratio = h > 0 ? window.scrollY / h : 0;
      progress.style.transform = `scaleX(${ratio})`;
      if (window.scrollY > 40) header.classList.add("scrolled");
      else header.classList.remove("scrolled");
    }
    window.addEventListener("scroll", updateProgress, { passive: true });
    
    let revealObserver;
    function setupReveal() {
      if (prefersReduced) {
        document.querySelectorAll(".page.active .reveal").forEach(el => el.classList.add("visible"));
        return;
      }
      if (revealObserver) revealObserver.disconnect();
      revealObserver = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) entry.target.classList.add("visible");
        });
      }, { threshold: 0.2 });
      document.querySelectorAll(".page.active .reveal").forEach(el => revealObserver.observe(el));
    }

    let countObserver;
    function setupCounters() {
      if (countObserver) countObserver.disconnect();
      const counters = document.querySelectorAll(".page.active [data-count]");
      if (!counters.length) return;
      if (prefersReduced) { counters.forEach(el => el.textContent = el.dataset.count); return; }
      countObserver = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            animateCount(entry.target); countObserver.unobserve(entry.target);
          }
        });
      }, { threshold: 0.6 });
      counters.forEach(el => countObserver.observe(el));
    }
    function animateCount(el) {
      const target = parseFloat(el.dataset.count);
      const duration = 900;
      const startTime = performance.now();
      const isFloat = String(target).includes(".");
      function tick(now) {
        const p = Math.min((now - startTime) / duration, 1);
        const value = target * p;
        el.textContent = isFloat ? value.toFixed(1) : Math.round(value);
        if (p < 1) requestAnimationFrame(tick);
      }
      requestAnimationFrame(tick);
    }

    // ==========================================
    // AUTH & HEADER UI
    // ==========================================
    function updateHeaderUI() {
        const commonLinks = `
            <a href="/" data-link data-nav>Home</a>
            <a href="/pricing" data-link data-nav>Pricing</a>
            <a href="/work" data-link data-nav>Work</a>
            <a href="/reviews" data-link data-nav>Reviews</a>
            <a href="/about" data-link data-nav>About</a>
            <a href="/contact" data-link data-nav>Contact</a>
        `;
        mainNav.innerHTML = commonLinks;
        
        let mobileLinks = commonLinks;
        let authHtml = '';

        if (auth && auth.currentUser) {
            authHtml = `<a href="/profile" class="btn btn-ghost" data-link>Profile</a>`;
            mobileLinks += `<a href="/profile" data-link><i class="ri-user-line"></i> Profile</a>`;
            if (currentUserRole === 'admin') {
                authHtml = `<a href="admin.html" target="_blank" class="icon-btn" title="Admin"><i class="ri-shield-user-fill"></i></a>` + authHtml;
                mobileLinks += `<a href="admin.html" target="_blank"><i class="ri-shield-user-fill"></i> Admin</a>`;
            }
            mobileLinks += `<a href="#" onclick="handleLogout()"><i class="ri-logout-box-r-line"></i> Logout</a>`;
        } else {
            authHtml = `<a href="/login" class="btn btn-ghost" data-link>Login</a>`;
            mobileLinks += `<a href="/login" data-link><i class="ri-login-circle-line"></i> Login</a>`;
        }
        
        authActions.innerHTML = authHtml;
        mobileMenu.innerHTML = mobileLinks;
        
        // Re-attach listeners for new links
        document.querySelectorAll("#authActions [data-link], #mobileMenu [data-link]").forEach(link => {
            link.addEventListener("click", (e) => {
                const href = link.getAttribute("href");
                if (!href || href.startsWith("http")) return;
                e.preventDefault();
                navigateTo(href);
            });
        });
    }

    if(auth) {
        auth.onAuthStateChanged((user) => {
            if (user) {
                db.collection("users").doc(user.uid).get().then((doc) => {
                    if (doc.exists) {
                        const data = doc.data();
                        currentUserRole = data.role || 'user';
                        if(data.personalVoucher) currentUserPersonalVoucher = data.personalVoucher;
                        
                        // Prefill forms if on relevant pages
                        if(document.getElementById('co-name')) {
                            document.getElementById('co-name').value = data.name || '';
                            document.getElementById('co-phone').value = data.phone || '';
                            document.getElementById('co-email').value = data.email || '';
                            document.getElementById('co-company').value = data.company || '';
                        }
                        if(document.getElementById('prof-name')) loadProfilePageData();
                    }
                    updateHeaderUI();
                });
            } else {
                currentUserRole = 'user';
                currentUserPersonalVoucher = null;
                updateHeaderUI();
            }
        });
    }

    function handleLogout() {
        if(auth) auth.signOut().then(() => { showToast("Logged out", "success"); navigateTo('/'); });
    }
    window.handleLogout = handleLogout;

    // ==========================================
    // TOAST & MODALS
    // ==========================================
    function showToast(message, type = 'info') {
        const wrap = document.getElementById("toastWrap");
        const t = document.createElement("div");
        t.className = `toast ${type}`;
        t.innerHTML = `<span>${message}</span>`;
        wrap.appendChild(t);
        setTimeout(() => t.remove(), 3500);
    }
    window.showToast = showToast;
    
    function closeIdeaSuccessModal() {
        document.getElementById('idea-success-modal').style.display = 'none';
        navigateTo('/');
    }
    window.closeIdeaSuccessModal = closeIdeaSuccessModal;

    // ==========================================
    // AUTH FORMS
    // ==========================================
    function handleLogin(e) {
        e.preventDefault();
        const email = document.getElementById('login-email').value;
        const password = document.getElementById('login-password').value;
        auth.signInWithEmailAndPassword(email, password)
            .then(() => { showToast("Login Successful!", "success"); navigateTo('/'); })
            .catch((error) => showToast(error.message, "error"));
    }
    
    function handleSignup(e) {
        e.preventDefault();
        const name = document.getElementById('signup-name').value;
        const phone = document.getElementById('signup-phone').value;
        const email = document.getElementById('signup-email').value;
        const password = document.getElementById('signup-password').value;
        
        auth.createUserWithEmailAndPassword(email, password)
            .then((userCredential) => {
                return db.collection("users").doc(userCredential.user.uid).set({
                    name, phone, email, role: 'user', createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
            })
            .then(() => { showToast("Account Created!", "success"); navigateTo('/'); })
            .catch((error) => showToast(error.message, "error"));
    }

    function handleProfileUpdate(e) {
        e.preventDefault();
        const name = document.getElementById('prof-name').value;
        const phone = document.getElementById('prof-phone').value;
        const company = document.getElementById('prof-company').value;
        db.collection("users").doc(auth.currentUser.uid).update({ name, phone, company })
            .then(() => { showToast("Profile Updated!", "success"); })
            .catch((err) => showToast(err.message, "error"));
    }

    function loadProfilePageData() {
        if(!auth.currentUser) return;
        db.collection("users").doc(auth.currentUser.uid).get().then((doc) => {
            if(doc.exists) {
                const d = doc.data();
                document.getElementById('prof-name').value = d.name || '';
                document.getElementById('prof-phone').value = d.phone || '';
                document.getElementById('prof-email').value = d.email || '';
                document.getElementById('prof-company').value = d.company || '';
                loadOrderHistory(auth.currentUser.uid);
            }
        });
    }
    
    function loadOrderHistory(uid) {
        if(!db) return;
        const container = document.getElementById('profile-history-section');
        const tbody = document.getElementById('order-history-body');
        container.style.display = 'block';
        
        db.collection("orders").where("userId", "==", uid).orderBy("timestamp", "desc").limit(10)
            .onSnapshot((snap) => {
                tbody.innerHTML = '';
                if(snap.empty) tbody.innerHTML = '<tr><td colspan="4">No orders found.</td></tr>';
                snap.forEach(doc => {
                    const d = doc.data();
                    const date = d.timestamp ? new Date(d.timestamp.seconds * 1000).toLocaleDateString() : '-';
                    tbody.innerHTML += `<tr><td>${date}</td><td>${d.package}</td><td>${d.total}</td><td><span class="status-badge status-${d.status.toLowerCase()}">${d.status}</span></td></tr>`;
                });
            });
    }

    // ==========================================
    // PRICING & CHECKOUT LOGIC
    // ==========================================
    function updatePricingUI() {
        const isMonthly = state.billingCycle === 'monthly';
        
        Object.keys(PRICING_DATA).forEach(key => {
            const p = PRICING_DATA[key];
            const priceEl = document.querySelector(`[data-price="${key}"]`);
            const setupEl = document.getElementById(`price-${key}-setup`);
            const featMaint = document.getElementById(`feat-${key}-maint`);
            const featNoSup = document.getElementById(`feat-${key}-nosupport`);
            
            if(priceEl) {
                const price = isMonthly ? p.monthly : p.oneTime;
                priceEl.innerHTML = `RM ${price} <span>/${isMonthly ? 'month' : 'one-time'}</span>`;
            }
            
            // Setup fee visibility (Hidden for one-time usually in this layout, or adjust as needed)
            // Assuming setup fee is only for monthly
            if(setupEl) setupEl.style.display = isMonthly ? 'block' : 'none';
            
            // Feature toggles
            if(featMaint) featMaint.classList.toggle('hidden', !isMonthly);
            if(featNoSup) featNoSup.classList.toggle('hidden', isMonthly);
        });
    }

    document.querySelectorAll("[data-billing]").forEach(btn => {
      btn.addEventListener("click", () => {
        state.billingCycle = btn.dataset.billing;
        document.querySelectorAll("[data-billing]").forEach(b => b.classList.toggle("active", b.dataset.billing === state.billingCycle));
        updatePricingUI();
      });
    });

    function attemptSelectPackage(name, type) {
        if (!auth || !auth.currentUser) {
            showToast("Please login to continue.", "error");
            setTimeout(() => navigateTo('/login'), 1500);
            return;
        }
        selectPackage(name, type);
    }
    window.attemptSelectPackage = attemptSelectPackage;

    function selectPackage(name, type) {
        state.packageType = type;
        state.isOneTime = state.billingCycle === 'onetime';
        
        const data = PRICING_DATA[type];
        state.packagePrice = state.isOneTime ? data.oneTime : data.monthly;
        state.setupFee = state.isOneTime ? 0 : data.setupFee;
        
        document.getElementById('summary-pkg-name').innerText = name;
        document.getElementById('summary-pkg-desc').innerText = data.desc;
        
        updateTotal();
        navigateTo('/checkout');
    }
    window.selectPackage = selectPackage;

    function updateDomain(type, el) {
        state.domainType = type;
        document.querySelectorAll('.radio-option', el.parentElement).forEach(o => o.classList.remove('selected'));
        el.classList.add('selected');
        
        document.getElementById('input-subdomain').style.display = type === 'sub' ? 'block' : 'none';
        document.getElementById('input-custom').style.display = type === 'custom' ? 'block' : 'none';
        
        state.domainPrice = 0; // Free logic
        updateTotal();
    }
    window.updateDomain = updateDomain;

    function updateMaintenance(plan, el) {
        document.querySelectorAll('.radio-option', el.parentElement).forEach(o => o.classList.remove('selected'));
        el.classList.add('selected');
        
        state.maintenancePrice = plan === 'basic' ? 50 : (plan === 'business' ? 100 : 0);
        document.getElementById('summary-maintenance').innerText = plan === 'none' ? 'None' : `${plan} (+RM ${state.maintenancePrice}/mo)`;
        updateTotal();
    }
    window.updateMaintenance = updateMaintenance;

    function updateTotal() {
        let total = state.packagePrice + state.setupFee + state.maintenancePrice;
        
        // Discount
        let discountVal = 0;
        if(state.discountType === 'fixed') discountVal = state.discountFixed;
        else discountVal = total * state.discountRate;
        
        total = Math.max(0, Math.round(total - discountVal));
        
        document.getElementById('summary-setup').innerText = `RM ${state.setupFee}`;
        document.getElementById('summary-recurring').innerText = `RM ${state.packagePrice} / ${state.isOneTime ? 'one-time' : 'month'}`;
        document.getElementById('summary-final-total').innerText = `RM ${total}`;
        
        if(state.paymentMode === 'deposit') {
            document.getElementById('deposit-note').style.display = 'block';
            document.getElementById('deposit-note').innerText = `Deposit (50%): RM ${Math.round(total * 0.5)}`;
        } else {
            document.getElementById('deposit-note').style.display = 'none';
        }
    }

    function setPaymentMode(mode) {
        state.paymentMode = mode;
        const btnFull = document.getElementById('btn-pay-full');
        const btnDep = document.getElementById('btn-pay-deposit');
        
        if(mode === 'full') {
            btnFull.classList.replace('btn-ghost', 'btn-primary');
            btnDep.classList.replace('btn-primary', 'btn-ghost');
        } else {
            btnFull.classList.replace('btn-primary', 'btn-ghost');
            btnDep.classList.replace('btn-ghost', 'btn-primary');
        }
        updateTotal();
    }
    window.setPaymentMode = setPaymentMode;

    // ==========================================
    // RAZORPAY & MANUAL CONFIRMATION
    // ==========================================
    function initiateRazorpayPayment() {
        const terms = document.getElementById('terms-check');
        if(!terms.checked) return showToast("Please agree to terms.", "error");
        
        const name = document.getElementById('co-name').value;
        const phone = document.getElementById('co-phone').value;
        const email = document.getElementById('co-email').value;
        
        if(!name || !phone || !email) return showToast("Please fill personal details.", "error");
        
        // Calculate amount
        const totalText = document.getElementById('summary-final-total').innerText;
        const amountNumeric = parseFloat(totalText.replace('RM ', ''));
        const amountInSubunits = Math.round(amountNumeric * 100);

        // Save pending order
        const pendingOrder = {
            userId: auth.currentUser ? auth.currentUser.uid : null,
            name, phone, email,
            company: document.getElementById('co-company').value,
            package: document.getElementById('summary-pkg-name').innerText,
            domainType: state.domainType,
            domainName: state.domainType === 'sub' ? `${document.getElementById('subdomain-text').value}.ddnet.my` : document.getElementById('custom-domain-text').value,
            packagePrice: state.packagePrice,
            setupFee: state.setupFee,
            maintenancePrice: state.maintenancePrice,
            total: `RM ${amountNumeric}`, 
            discountCode: state.discountCode || null,
            paymentMethod: 'Razorpay',
            paymentMode: state.paymentMode,
            billingCycle: state.isOneTime ? 'One-Time' : 'Monthly',
            status: 'Paid',
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };
        localStorage.setItem('pendingOrder', JSON.stringify(pendingOrder));

        const options = {
            "key": RAZORPAY_KEY_ID, 
            "amount": amountInSubunits, 
            "currency": "MYR", 
            "name": "DDNetwork One",
            "description": document.getElementById('summary-pkg-name').innerText,
            "image": "https://raw.githubusercontent.com/ddnetwork-one/ddnetwork-store/refs/heads/main/crop_ddnlogo.png",
            "handler": function(response){ console.log(response); },
            "prefill": { name, email, contact: phone },
            "theme": { "color": "#0b0f14" }
        };

        try {
            const rzp1 = new Razorpay(options);
            rzp1.open();
            
            // Show Manual UI
            document.getElementById('checkout-actions').style.display = 'none';
            document.getElementById('manual-confirm-section').style.display = 'block';
        } catch(e) {
            showToast("Payment gateway error.", "error");
        }
    }
    window.initiateRazorpayPayment = initiateRazorpayPayment;

    function handleManualConfirmation() {
        const data = JSON.parse(localStorage.getItem('pendingOrder'));
        if(!data) return showToast("Order data missing. Please contact support.", "error");
        
        document.getElementById('processing-overlay').style.display = 'flex';
        
        // Update Voucher if used
        let voucherPromise = Promise.resolve();
        if (data.discountCode && auth.currentUser) {
            voucherPromise = db.collection("users").doc(auth.currentUser.uid).update({
                "personalVoucher.status": "redeemed"
            });
        }

        voucherPromise.then(() => {
            const orderData = {
                adminNote: "OWN COMPANY CREATED",
                companyName: data.company || "DDNetwork One",
                customerEmail: data.email,
                customerName: data.name,
                customerPhone: data.phone,
                domain: data.domainName,
                internalNotes: "",
                maintenance: data.maintenancePrice > 0 ? (data.maintenancePrice === 50 ? "Basic" : "Business") : "None",
                package: data.package,
                paymentMethod: "Razorpay (Curlec)",
                promo: data.discountCode || "",
                salesRepIds: [], 
                salesTeamIds: [],
                salesTeamNames: [],
                status: "Completed",
                timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                total: data.total,
                userId: data.userId || ""
            };

            return db.collection("orders").add(orderData);
        }).then(() => {
            localStorage.removeItem('pendingOrder');
            showToast("Order Submitted!", "success");
            navigateTo('/');
        }).catch(err => {
            console.error(err);
            showToast("Error submitting order.", "error");
            document.getElementById('processing-overlay').style.display = 'none';
        });
    }
    window.handleManualConfirmation = handleManualConfirmation;

    // ==========================================
    // HELPDESK & TICKETS
    // ==========================================
    async function generateSmartTicketId() {
        const snapshot = await db.collection("tickets").orderBy("ticketId", "desc").limit(1).get();
        let next = 1;
        if (!snapshot.empty) {
            const last = snapshot.docs[0].data().ticketId;
            const num = parseInt(last.split('-')[1]);
            if (!isNaN(num)) next = num + 1;
        }
        return `#Ticket-${String(next).padStart(4, '0')}`;
    }

    async function handleTicketSubmit(e) {
        e.preventDefault();
        const btn = e.target.querySelector('button');
        btn.disabled = true;
        
        try {
            const tid = await generateSmartTicketId();
            const data = {
                ticketId: tid,
                name: document.getElementById('ticket-name').value,
                email: document.getElementById('ticket-email').value,
                type: document.getElementById('ticket-type').value,
                message: document.getElementById('ticket-message').value,
                status: "Open",
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            await db.collection("tickets").add(data);
            document.getElementById('display-case-id').innerText = tid;
            document.getElementById('case-id-display').style.display = 'block';
            e.target.reset();
            showToast(`Ticket Submitted! ID: ${tid}`, "success");
        } catch(err) {
            showToast("Error submitting ticket.", "error");
        } finally {
            btn.disabled = false;
        }
    }

    function fetchTicketHistory() {
        const id = document.getElementById('history-search-id').value;
        if(!id) return;
        const list = document.getElementById('ticket-list');
        list.innerHTML = '<div style="text-align:center; color:var(--muted);">Searching...</div>';
        
        db.collection("tickets").where("ticketId", "==", id).get()
            .then(snap => {
                list.innerHTML = '';
                if(snap.empty) list.innerHTML = '<div style="color:var(--danger);">No ticket found.</div>';
                snap.forEach(doc => {
                    const d = doc.data();
                    const date = d.timestamp ? new Date(d.timestamp.seconds * 1000).toLocaleDateString() : '-';
                    list.innerHTML += `<div class="card" style="padding:1rem; margin-bottom:0.5rem;"><strong>${d.type}</strong> <span style="float:right; font-size:0.8rem; color:var(--brand);">${d.status}</span><br><span style="font-size:0.8rem; color:var(--muted);">${date}</span></div>`;
                });
            });
    }
    window.fetchTicketHistory = fetchTicketHistory;

    // ==========================================
    // REVIEWS
    // ==========================================
    const reviewSlides = Array.from(document.querySelectorAll(".review-slide"));
    const dotsWrap = document.getElementById("reviewDots");
    let reviewIndex = 0;
    let reviewTimer = null;
    
    function startReviews() {
      if (reviewTimer) return;
      // Load dynamic reviews from DB if needed here, for now use static
      reviewSlides.forEach((_, i) => {
        const dot = document.createElement("div");
        dot.className = "dot" + (i === 0 ? " active" : "");
        dot.addEventListener("click", () => showReview(i));
        dotsWrap.appendChild(dot);
      });
      reviewTimer = setInterval(() => {
        const next = (reviewIndex + 1) % reviewSlides.length;
        showReview(next);
      }, 4500);
    }
    function stopReviews() {
      clearInterval(reviewTimer);
      reviewTimer = null;
      dotsWrap.innerHTML = '';
    }
    function showReview(i) {
      reviewSlides.forEach(s => s.classList.remove("active"));
      dotsWrap.querySelectorAll(".dot").forEach(d => d.classList.remove("active"));
      if(reviewSlides[i]) reviewSlides[i].classList.add("active");
      if(dotsWrap.querySelectorAll(".dot")[i]) dotsWrap.querySelectorAll(".dot")[i].classList.add("active");
      reviewIndex = i;
    }

    function handleReviewSubmit(e) {
        e.preventDefault();
        const comment = document.getElementById('review-comment').value;
        const rating = document.getElementById('rating-value').value;
        
        if(!rating) return showToast("Please select a star rating.", "error");
        
        db.collection("customer_reviews").add({
            userId: auth.currentUser.uid,
            userName: auth.currentUser.displayName || 'User',
            rating: parseInt(rating),
            comment: comment,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        }).then(() => {
            showToast("Review submitted!", "success");
            e.target.reset();
        }).catch(err => showToast(err.message, "error"));
    }
    
    // Star Rating Logic
    const stars = document.querySelectorAll('.star-icon');
    stars.forEach(star => {
        star.addEventListener('click', function() {
            const val = this.getAttribute('data-val');
            document.getElementById('rating-value').value = val;
            stars.forEach(s => s.style.color = s.getAttribute('data-val') <= val ? 'var(--brand-3)' : 'var(--muted)');
        });
    });

    // ==========================================
    // MISC FORMS (Idea, Contact)
    // ==========================================
    function handleWebsiteIdeaSubmit(e) {
        e.preventDefault();
        const data = {
            name: document.getElementById('idea-name').value,
            phone: document.getElementById('idea-phone').value,
            email: document.getElementById('idea-email').value,
            type: document.getElementById('idea-type').value,
            details: document.getElementById('idea-message').value,
            status: 'Pending',
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };
        db.collection("customer_requests").add(data).then(() => {
            document.getElementById('idea-success-modal').style.display = 'flex';
            e.target.reset();
        });
    }

    function handleContactSubmit(e) {
        e.preventDefault();
        const data = {
            name: e.target.name.value,
            email: e.target.email.value,
            message: e.target.message.value,
            type: 'Contact',
            status: 'Pending',
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };
        db.collection("customer_requests").add(data).then(() => {
            showToast("Message sent!", "success");
            e.target.reset();
        });
    }

    function handleRequestSubmit(e) {
        e.preventDefault();
        const type = document.querySelector('input[name="req_type"]:checked').value;
        const data = {
            name: document.getElementById('req-name').value,
            phone: document.getElementById('req-phone').value,
            type: type,
            details: document.getElementById('req-desc-content').value, // simplified
            status: 'Pending',
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };
        db.collection("customer_requests").add(data).then(() => {
            showToast("Request submitted!", "success");
            e.target.reset();
        });
    }

    function handleUpdateTypeChange(type, el) {
        document.querySelectorAll('#updates .radio-option').forEach(o => o.classList.remove('selected'));
        el.classList.add('selected');
    }
    window.handleUpdateTypeChange = handleUpdateTypeChange;

    // ==========================================
    // LOAD PORTFOLIO
    // ==========================================
    function loadPortfolio() {
        if(!db) return;
        const container = document.getElementById('portfolio-grid');
        container.innerHTML = '<div class="text-center" style="grid-column:1/-1;">Loading...</div>';
        
        db.collection("clients_portfolio").where("status", "==", true).limit(6).get().then(snap => {
            container.innerHTML = '';
            if(snap.empty) container.innerHTML = '<div class="text-center" style="grid-column:1/-1;">No projects yet.</div>';
            snap.forEach(doc => {
                const d = doc.data();
                container.innerHTML += `
                    <div class="card work-card">
                        <img src="${d.img}" alt="${d.name}">
                        <h3>${d.name}</h3>
                        <p style="color:var(--muted); margin-bottom:1rem;">${d.desc || 'View Project'}</p>
                        <a href="${d.link}" target="_blank" class="btn btn-ghost" style="width:100%;">Visit Site</a>
                    </div>
                `;
            });
        });
    }

    // ==========================================
    // INIT
    // ==========================================
    render(getPath(), true);
    updatePricingUI();
    loadPortfolio();
  </script>
</body>
</html>
