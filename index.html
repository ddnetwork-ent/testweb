<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DDNetwork One — Premium Web Systems</title>
  <meta name="description" content="DDNetwork One designs premium websites, portals, and AI‑assisted experiences for modern businesses." />
  <meta name="theme-color" content="#0b0f14" />
  <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/ddnetwork-one/ddnetwork-store/refs/heads/main/crop_ddnlogo.png" />

  <!-- Fonts: Sora (display) + Manrope (body) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700&family=Sora:wght@500;600;700&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  
  <!-- Razorpay -->
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

  <style>
    :root {
      --bg: #0b0f14;
      --bg-soft: #0f141b;
      --panel: rgba(255, 255, 255, 0.04);
      --panel-2: rgba(255, 255, 255, 0.06);
      --border: rgba(255, 255, 255, 0.08);
      --text: #e9eef5;
      --muted: #9fb0c4;

      --brand: #76f7d2;
      --brand-2: #8ab4ff;
      --brand-3: #ffd37c;

      --danger: #ff6b6b;
      --accent-success: #10b981;
      --accent-warn: #f59e0b;
      --shadow: 0 20px 60px rgba(0,0,0,0.4);

      --font-display: "Sora", sans-serif;
      --font-body: "Manrope", sans-serif;

      --radius: 18px;
      --radius-lg: 28px;
      --ease: cubic-bezier(.16,1,.3,1);
      --header-h: 72px;
    }

    body.theme-light {
      --bg: #f5f7fb;
      --bg-soft: #ffffff;
      --panel: rgba(255,255,255,0.75);
      --panel-2: rgba(255,255,255,0.9);
      --border: rgba(15, 23, 42, 0.08);
      --text: #0b1220;
      --muted: #5f6c82;

      --brand: #0ea5e9;
      --brand-2: #6366f1;
      --brand-3: #f59e0b;
      --shadow: 0 20px 60px rgba(15, 23, 42, 0.12);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--font-body);
      line-height: 1.6;
      min-height: 100vh;
      overflow-x: hidden;
    }
    a { color: inherit; text-decoration: none; }
    img { display: block; max-width: 100%; }
    button { font-family: inherit; cursor: pointer; }
    .container { width: min(1200px, 92%); margin: 0 auto; }

    /* Background atmosphere */
    .bg-grid {
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(to right, rgba(255,255,255,0.03) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(255,255,255,0.03) 1px, transparent 1px);
      background-size: 64px 64px;
      pointer-events: none;
      z-index: 0;
      opacity: 0.35;
    }
    .orb {
      position: fixed;
      width: 420px;
      height: 420px;
      filter: blur(40px);
      opacity: 0.35;
      border-radius: 50%;
      z-index: 0;
      animation: float 18s ease-in-out infinite;
    }
    .orb.one {
      background: radial-gradient(circle, var(--brand), transparent 60%);
      top: -140px; right: 6%;
    }
    .orb.two {
      background: radial-gradient(circle, var(--brand-2), transparent 60%);
      bottom: -160px; left: 8%;
      animation-delay: -6s;
    }
    .orb.three {
      background: radial-gradient(circle, var(--brand-3), transparent 60%);
      top: 45%; left: 60%;
      animation-delay: -10s;
    }
    @keyframes float {
      0%,100% { transform: translateY(0); }
      50% { transform: translateY(18px); }
    }

    /* Progress bar */
    .progress {
      position: fixed;
      top: 0; left: 0;
      height: 3px;
      width: 100%;
      transform-origin: 0 50%;
      transform: scaleX(0);
      background: linear-gradient(90deg, var(--brand), var(--brand-2));
      z-index: 100;
    }

    /* Header */
    header {
      position: fixed;
      top: 16px; left: 50%;
      transform: translateX(-50%);
      width: min(1200px, 94%);
      height: var(--header-h);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 18px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(10,14,20,0.7);
      backdrop-filter: blur(18px);
      z-index: 50;
      transition: all 0.3s var(--ease);
    }
    body.theme-light header { background: rgba(255,255,255,0.85); }
    header.scrolled {
      top: 0;
      border-radius: 0;
      width: 100%;
      box-shadow: var(--shadow);
    }

    .logo {
      display: flex; align-items: center; gap: 12px;
      font-family: var(--font-display); font-weight: 700;
      letter-spacing: -0.02em;
    }
    .logo img { width: 34px; height: 34px; }

    nav.nav {
      display: none;
      gap: 18px;
      align-items: center;
      font-weight: 600;
      color: var(--muted);
    }
    nav.nav a {
      padding: 8px 12px;
      border-radius: 999px;
      transition: all 0.2s var(--ease);
    }
    nav.nav a.active {
      color: var(--text);
      background: var(--panel-2);
      border: 1px solid var(--border);
    }
    nav.nav a:hover { color: var(--text); }

    .nav-actions {
      display: flex; gap: 10px; align-items: center;
    }

    .btn {
      padding: 12px 18px;
      border-radius: 999px;
      border: 1px solid transparent;
      font-weight: 600;
      transition: all 0.25s var(--ease);
      display: inline-flex;
      align-items: center;
      gap: 10px;
      white-space: nowrap;
      font-size: 0.9rem;
      background: var(--panel);
      color: var(--text);
    }
    .btn-primary {
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      color: #0b0f14;
      box-shadow: 0 10px 30px rgba(118,247,210,0.3);
    }
    .btn-primary:hover { transform: translateY(-2px); }
    .btn-ghost {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--text);
    }
    .btn-ghost:hover { border-color: rgba(255,255,255,0.2); background: var(--panel); }
    .btn-danger { background: var(--danger); color: white; }
    .icon-btn {
      width: 40px; height: 40px;
      border-radius: 50%;
      display: grid; place-items: center;
      background: var(--panel);
      border: 1px solid var(--border);
      color: var(--text);
      transition: all 0.2s var(--ease);
    }
    .icon-btn:hover { transform: translateY(-2px); }

    .menu-toggle { font-size: 1.6rem; }

    /* Mobile menu */
    .mobile-menu {
      position: fixed;
      inset: 0;
      background: rgba(10,14,20,0.96);
      z-index: 60;
      padding: 100px 24px 24px;
      display: none;
      overflow-y: auto;
    }
    body.theme-light .mobile-menu { background: rgba(255,255,255,0.96); }
    .mobile-menu.open { display: block; }
    .mobile-menu a {
      display: block;
      padding: 14px 0;
      font-size: 1.1rem;
      border-bottom: 1px solid var(--border);
    }

    /* Pages */
    main { position: relative; z-index: 2; }
    .page { display: none; padding-top: 120px; padding-bottom: 80px; }
    .page.active { display: block; animation: fadeIn 0.4s var(--ease); }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

    /* Reveal */
    .reveal { opacity: 0; transform: translateY(16px); transition: all 0.6s var(--ease); }
    .reveal.visible { opacity: 1; transform: translateY(0); }

    /* Hero */
    .hero {
      display: grid;
      gap: 48px;
      grid-template-columns: 1fr;
      align-items: center;
    }
    .tag {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 14px;
      border-radius: 999px;
      background: rgba(118,247,210,0.12);
      border: 1px solid rgba(118,247,210,0.3);
      color: var(--brand);
      font-size: 0.85rem;
      font-weight: 600;
    }
    .hero h1 {
      font-family: var(--font-display);
      font-size: clamp(2.6rem, 6vw, 5.2rem);
      line-height: 1.04;
      letter-spacing: -0.03em;
      margin: 18px 0;
    }
    .hero p { color: var(--muted); font-size: 1.05rem; max-width: 600px; }
    .hero-cta { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 22px; }

    .hero-panel {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 22px;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }
    .panel-head {
      display: flex; align-items: center; justify-content: space-between;
      margin-bottom: 14px;
    }
    .chip {
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(138,180,255,0.15);
      color: var(--brand-2);
      font-size: 0.75rem;
      border: 1px solid rgba(138,180,255,0.3);
    }

    .wave {
      display: flex; align-items: flex-end; gap: 4px;
      height: 80px; margin: 12px 0 18px;
    }
    .wave span {
      width: 6px;
      height: 40%;
      background: linear-gradient(180deg, var(--brand), var(--brand-2));
      border-radius: 6px;
      animation: wave 1.1s ease-in-out infinite;
      animation-delay: calc(var(--i) * 0.08s);
    }
    @keyframes wave {
      0%,100% { transform: scaleY(0.35); }
      50% { transform: scaleY(1); }
    }

    .panel-metrics {
      display: grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap: 10px;
    }
    .metric {
      background: var(--panel-2);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
      text-align: left;
    }
    .metric h4 { font-family: var(--font-display); font-size: 1.1rem; margin-bottom: 4px; }
    .metric span { color: var(--muted); font-size: 0.85rem; }

    /* Sections */
    .section-title {
      font-family: var(--font-display);
      font-size: clamp(1.6rem, 3.6vw, 2.6rem);
      margin-bottom: 10px;
    }
    .section-sub { color: var(--muted); max-width: 680px; }

    .strip {
      border-top: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
      padding: 16px 0;
      margin: 60px 0;
      overflow: hidden;
      background: rgba(255,255,255,0.02);
    }
    .strip-track {
      display: flex; gap: 32px; width: max-content;
      color: var(--muted); font-weight: 600;
      animation: marquee 28s linear infinite;
    }
    @keyframes marquee { from { transform: translateX(0); } to { transform: translateX(-50%); } }

    /* Grids */
    .grid-3 {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 18px;
    }

    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 22px;
      transition: transform 0.25s var(--ease), box-shadow 0.25s var(--ease);
      margin-bottom: 20px;
    }
    .card:hover { transform: translateY(-6px); box-shadow: var(--shadow); }

    .icon-pill {
      width: 42px; height: 42px;
      border-radius: 12px;
      display: grid; place-items: center;
      background: rgba(118,247,210,0.12);
      color: var(--brand);
      border: 1px solid rgba(118,247,210,0.3);
      margin-bottom: 12px;
      font-size: 1.2rem;
    }

    .stats-grid {
      display: grid; gap: 16px;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      margin-top: 22px;
    }
    .stat-card {
      background: var(--panel-2);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 14px;
      text-align: left;
    }
    .stat-number {
      font-family: var(--font-display);
      font-size: 1.6rem;
      margin-bottom: 4px;
    }

    /* Pricing */
    .pricing-toggle {
      display: inline-flex;
      gap: 6px;
      padding: 6px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--panel);
      margin: 18px 0;
    }
    .toggle-btn {
      padding: 8px 14px;
      border-radius: 999px;
      border: none;
      background: transparent;
      color: var(--muted);
      font-weight: 600;
    }
    .toggle-btn.active {
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      color: #0b0f14;
    }

    .price-card {
      border-radius: var(--radius-lg);
      padding: 24px;
      background: linear-gradient(180deg, var(--panel-2), var(--panel));
      border: 1px solid var(--border);
      position: relative;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    .price-card.featured {
      border-color: rgba(118,247,210,0.45);
      box-shadow: 0 24px 70px rgba(118,247,210,0.18);
    }
    .price {
      font-size: 2.2rem;
      font-family: var(--font-display);
      margin: 10px 0 8px;
    }
    .price span { color: var(--muted); font-size: 0.95rem; }
    .list {
      display: grid;
      gap: 8px;
      color: var(--muted);
      font-size: 0.95rem;
      margin: 12px 0 18px;
      flex-grow: 1;
    }
    .list i { color: var(--brand); }

    /* Work */
    .work-card img {
      border-radius: 14px;
      border: 1px solid var(--border);
      margin-bottom: 12px;
      width: 100%;
      height: 200px;
      object-fit: cover;
    }

    /* Reviews slider */
    .review-slider {
      position: relative;
      min-height: 220px;
      margin-top: 20px;
    }
    .review-slide {
      position: absolute;
      inset: 0;
      opacity: 0;
      transform: translateY(8px);
      transition: all 0.5s var(--ease);
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
    }
    .review-slide.active {
      opacity: 1;
      transform: translateY(0);
      position: relative;
    }
    .stars { color: var(--brand-3); letter-spacing: 2px; }
    .dots {
      display: flex; gap: 8px; margin-top: 12px;
    }
    .dot {
      width: 8px; height: 8px; border-radius: 50%;
      background: var(--border);
      cursor: pointer;
    }
    .dot.active { background: var(--brand); }

    /* Forms & Inputs */
    .form {
      display: grid;
      gap: 12px;
    }
    .input, .textarea, .form-select {
      width: 100%;
      padding: 14px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--panel);
      color: var(--text);
      font-family: inherit;
      transition: 0.2s;
    }
    .input:focus, .textarea:focus { border-color: var(--brand); outline: none; }
    .textarea { min-height: 120px; resize: vertical; }
    
    /* Tables */
    .history-table-container { 
        width: 100%; overflow-x: auto; 
        border: 1px solid var(--border); border-radius: 12px; 
        background: var(--panel); 
    }
    .history-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
    .history-table th { text-align: left; padding: 12px; border-bottom: 1px solid var(--border); color: var(--muted); }
    .history-table td { padding: 12px; border-bottom: 1px solid var(--border); }
    
    /* Modal & Toast */
    .modal-overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.7);
      display: none; justify-content: center; align-items: center;
      z-index: 200;
    }
    .modal-overlay.active { display: flex; }
    .modal-content {
      background: var(--bg-soft); border: 1px solid var(--border);
      padding: 2rem; border-radius: var(--radius); max-width: 500px;
      text-align: center;
    }
    
    .toast-wrap {
      position: fixed;
      right: 18px; bottom: 18px;
      display: grid; gap: 10px;
      z-index: 120;
    }
    .toast {
      background: var(--panel-2);
      border: 1px solid var(--border);
      padding: 12px 14px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      animation: slideIn 0.3s ease-out;
    }
    @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

    /* Responsive */
    @media (min-width: 960px) {
      nav.nav { display: flex; }
      .menu-toggle { display: none; }
      .hero { grid-template-columns: 1.2fr 0.8fr; }
    }
    @media (max-width: 640px) {
      header { padding: 0 12px; }
      .nav-actions .btn-ghost { display: none; }
      .review-slider { min-height: 260px; }
    }

    @media (prefers-reduced-motion: reduce) {
      * { animation: none !important; transition: none !important; }
    }
  </style>
</head>
<body>
  <div class="bg-grid"></div>
  <div class="orb one"></div>
  <div class="orb two"></div>
  <div class="orb three"></div>
  <div class="progress" id="progress"></div>

  <header id="siteHeader">
    <a href="/" class="logo" data-link>
      <img src="https://raw.githubusercontent.com/ddnetwork-one/ddnetwork-store/refs/heads/main/crop_ddnlogo.png" alt="DDNetwork One logo">
      DDNetwork One
    </a>

    <nav class="nav">
      <a href="/" data-link data-nav>Home</a>
      <a href="/pricing" data-link data-nav>Pricing</a>
      <a href="/work" data-link data-nav>Work</a>
      <a href="/reviews" data-link data-nav>Reviews</a>
      <a href="/about" data-link data-nav>About</a>
      <a href="/contact" data-link data-nav>Contact</a>
      <div id="nav-auth-state"></div>
    </nav>

    <div class="nav-actions">
      <button class="icon-btn" id="themeToggle" aria-pressed="false" title="Toggle theme">
        <i class="ri-sun-line"></i>
      </button>
      <div id="header-auth-btns"></div>
      <div class="menu-toggle" id="menuToggle"><i class="ri-menu-4-line"></i></div>
    </div>
  </header>

  <div class="mobile-menu" id="mobileMenu">
    <a href="/" data-link>Home</a>
    <a href="/pricing" data-link>Pricing</a>
    <a href="/work" data-link>Work</a>
    <a href="/reviews" data-link>Reviews</a>
    <a href="/about" data-link>About</a>
    <a href="/contact" data-link>Contact</a>
    <div id="mobile-auth-links"></div>
  </div>

  <main id="app">
    <!-- HOME -->
    <section class="page active" data-route="/" data-title="DDNetwork One — Premium Web Systems">
      <div class="container hero">
        <div class="reveal">
          <span class="tag"><i class="ri-sparkling-2-fill"></i> Malaysia‑built, global‑ready</span>
          <h1>Premium websites, portals, and AI experiences.</h1>
          <p>DDNetwork One helps ambitious teams build conversion‑ready web experiences with clean design, measurable performance, and scalable systems.</p>
          <div class="hero-cta">
            <a href="/pricing" class="btn btn-primary" data-link>Explore Packages</a>
            <a href="/work" class="btn btn-ghost" data-link>See Recent Work</a>
          </div>
        </div>

        <div class="hero-panel reveal">
          <div class="panel-head">
            <strong style="font-family:var(--font-display);">Studio Preview</strong>
            <span class="chip">Live System</span>
          </div>
          <div class="wave">
            <span style="--i:1"></span><span style="--i:2"></span><span style="--i:3"></span>
            <span style="--i:4"></span><span style="--i:5"></span><span style="--i:6"></span>
            <span style="--i:7"></span><span style="--i:8"></span><span style="--i:9"></span>
            <span style="--i:10"></span>
          </div>
          <div class="panel-metrics">
            <div class="metric"><h4>5.0</h4><span>Avg. rating</span></div>
            <div class="metric"><h4>24h</h4><span>Response</span></div>
            <div class="metric"><h4>SEO</h4><span>Baseline</span></div>
          </div>
        </div>
      </div>
    </section>

    <!-- PRICING -->
    <section class="page" data-route="/pricing" data-title="Pricing — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">Pricing</h2>
        <p class="section-sub reveal">Clear packages with optional custom upgrades.</p>

        <div class="pricing-toggle reveal">
          <button class="toggle-btn active" data-billing="monthly">Monthly</button>
          <button class="toggle-btn" data-billing="onetime">One‑Time</button>
        </div>

        <div class="grid-3">
          <!-- Basic -->
          <div class="price-card reveal">
            <h3>Basic HTML</h3>
            <div class="price" data-price="starter">RM 99 <span>/month</span></div>
            <div class="list">
              <div><i class="ri-check-line"></i> 1 landing page</div>
              <div><i class="ri-check-line"></i> Mobile responsive</div>
              <div><i class="ri-check-line"></i> Basic SEO</div>
              <div><i class="ri-check-line"></i> Contact form</div>
            </div>
            <button class="btn btn-ghost" onclick="attemptSelectPackage('Basic HTML Website', 'html')">Select</button>
          </div>

          <!-- Frontend -->
          <div class="price-card featured reveal">
            <h3>Front‑End Website</h3>
            <div class="price" data-price="growth">RM 249 <span>/month</span></div>
            <div class="list">
              <div><i class="ri-check-line"></i> Up to 5 pages</div>
              <div><i class="ri-check-line"></i> Interactive UI</div>
              <div><i class="ri-check-line"></i> WhatsApp integration</div>
              <div><i class="ri-check-line"></i> Hosting included</div>
            </div>
            <button class="btn btn-primary" onclick="attemptSelectPackage('Front-End Website', 'frontend')">Select</button>
          </div>

          <!-- AI -->
          <div class="price-card reveal">
            <h3>AI‑Powered</h3>
            <div class="price" data-price="ai">RM 349 <span>/month</span></div>
            <div class="list">
              <div><i class="ri-check-line"></i> AI chatbot</div>
              <div><i class="ri-check-line"></i> Lead automation</div>
              <div><i class="ri-check-line"></i> Smart analytics</div>
              <div><i class="ri-check-line"></i> Custom workflows</div>
            </div>
            <button class="btn btn-ghost" onclick="attemptSelectPackage('AI Powered', 'ai')">Select</button>
          </div>
        </div>
      </div>
    </section>

    <!-- WORK -->
    <section class="page" data-route="/work" data-title="Work — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">Recent work</h2>
        <p class="section-sub reveal">A snapshot of recent client projects.</p>
        <div class="grid-3" style="margin-top:20px;" id="portfolio-grid">
          <!-- Populated by JS -->
          <div class="text-center" style="grid-column: 1/-1;">Loading...</div>
        </div>
      </div>
    </section>

    <!-- REVIEWS -->
    <section class="page" data-route="/reviews" data-title="Reviews — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">Client reviews</h2>
        <p class="section-sub reveal">Real feedback from teams who shipped with us.</p>

        <div class="review-slider reveal" id="reviewSlider">
          <!-- Populated by JS -->
        </div>
        <div class="dots" id="reviewDots"></div>
        
        <div class="card reveal" style="margin-top: 2rem;">
            <h3 style="margin-bottom: 1rem;">Leave a Review</h3>
            <form onsubmit="handleReviewSubmit(event)">
                <div class="form">
                    <div style="display: flex; gap: 5px; color: var(--brand-3); cursor: pointer;" id="star-input-container">
                        <i class="ri-star-fill" data-val="1"></i>
                        <i class="ri-star-fill" data-val="2"></i>
                        <i class="ri-star-fill" data-val="3"></i>
                        <i class="ri-star-fill" data-val="4"></i>
                        <i class="ri-star-fill" data-val="5"></i>
                    </div>
                    <input type="hidden" id="rating-value" value="5">
                    <textarea class="textarea" id="review-comment" placeholder="Share your experience..." required></textarea>
                    <button type="submit" class="btn btn-primary">Submit Review</button>
                </div>
            </form>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section class="page" data-route="/about" data-title="About — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">About us</h2>
        <p class="section-sub reveal">DDNetwork One is a specialized brand under DD Cloud Network, focused on building clean, high‑performance web systems.</p>
        <div class="grid-3" style="margin-top:20px;">
          <div class="card reveal">
            <h3>Our mission</h3>
            <p>Build digital systems that feel effortless for users and scalable for teams.</p>
          </div>
          <div class="card reveal">
            <h3>Our approach</h3>
            <p>We prioritize clarity, speed, and measurable outcomes.</p>
          </div>
          <div class="card reveal">
            <h3>Founder</h3>
            <p>Danial Danish leads the team, focusing on design clarity and modern systems.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- CONTACT -->
    <section class="page" data-route="/contact" data-title="Contact — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">Let’s talk</h2>
        <p class="section-sub reveal">Tell us about your project and we’ll respond within 24 hours.</p>

        <div class="card reveal" style="margin-top:18px;">
          <form id="contactForm" class="form" onsubmit="handleContactSubmit(event)">
            <div style="display:grid; gap:12px; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));">
              <input class="input" type="text" name="name" placeholder="Full Name" required>
              <input class="input" type="email" name="email" placeholder="Email Address" required>
            </div>
            <textarea class="textarea" name="message" placeholder="Tell us about your project..." required></textarea>
            <button type="submit" class="btn btn-primary">Send Message</button>
          </form>
          <div style="margin-top:14px; color:var(--muted);">
            Email: <strong style="color:var(--text);">sales@ddnet.my</strong>
          </div>
        </div>
      </div>
    </section>

    <!-- LOGIN -->
    <section class="page" data-route="/login" data-title="Login">
        <div class="container" style="max-width: 500px;">
            <div class="card reveal">
                <h2 class="section-title" style="font-size: 1.8rem;">Welcome Back</h2>
                <p class="section-sub">Login to manage your orders.</p>
                <form class="form" style="margin-top: 1.5rem;" onsubmit="handleLogin(event)">
                    <input class="input" type="email" id="login-email" placeholder="Email" required>
                    <input class="input" type="password" id="login-password" placeholder="Password" required>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Login</button>
                </form>
                <div style="margin-top: 1rem; text-align: center;">
                    <button class="btn btn-ghost" style="width: 100%;" onclick="handleGoogleAuth()">
                        <i class="ri-google-fill"></i> Continue with Google
                    </button>
                </div>
                <p style="margin-top: 1rem; text-align: center; color: var(--muted);">
                    No account? <a href="/signup" data-link style="color: var(--brand);">Sign Up</a>
                </p>
            </div>
        </div>
    </section>

    <!-- SIGNUP -->
    <section class="page" data-route="/signup" data-title="Sign Up">
        <div class="container" style="max-width: 500px;">
            <div class="card reveal">
                <h2 class="section-title" style="font-size: 1.8rem;">Create Account</h2>
                <form class="form" style="margin-top: 1.5rem;" onsubmit="handleSignup(event)">
                    <input class="input" type="text" id="signup-name" placeholder="Full Name" required>
                    <input class="input" type="tel" id="signup-phone" placeholder="Phone Number" required>
                    <input class="input" type="email" id="signup-email" placeholder="Email" required>
                    <input class="input" type="password" id="signup-password" placeholder="Password" required>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Create Account</button>
                </form>
                <p style="margin-top: 1rem; text-align: center; color: var(--muted);">
                    Have an account? <a href="/login" data-link style="color: var(--brand);">Login</a>
                </p>
            </div>
        </div>
    </section>

    <!-- PROFILE -->
    <section class="page" data-route="/profile" data-title="Profile">
        <div class="container">
            <div class="grid-3">
                <div class="card reveal" style="grid-column: span 2;">
                    <h3>My Details</h3>
                    <form class="form" style="margin-top: 1rem;" onsubmit="handleProfileUpdate(event)">
                        <div style="display:grid; gap:12px; grid-template-columns: 1fr 1fr;">
                            <input class="input" type="text" id="prof-name" placeholder="Name">
                            <input class="input" type="email" id="prof-email" placeholder="Email" readonly>
                            <input class="input" type="tel" id="prof-phone" placeholder="Phone">
                            <input class="input" type="text" id="prof-company" placeholder="Company (Optional)">
                        </div>
                        <button type="submit" class="btn btn-primary">Update Profile</button>
                    </form>
                </div>
                <div class="card reveal">
                    <h3>Actions</h3>
                    <div class="form" style="margin-top: 1rem;">
                        <button class="btn btn-ghost" style="justify-content: flex-start;" onclick="navigateTo('/helpdesk')">
                            <i class="ri-customer-service-2-line"></i> Helpdesk
                        </button>
                        <button class="btn btn-ghost" style="justify-content: flex-start;" onclick="handleLogout()">
                            <i class="ri-logout-box-line"></i> Logout
                        </button>
                    </div>
                </div>
            </div>

            <div class="card reveal" style="margin-top: 2rem;">
                <h3>Order History</h3>
                <div class="history-table-container" style="margin-top: 1rem;">
                    <table class="history-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Package</th>
                                <th>Total</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="order-history-body">
                            <tr><td colspan="4" style="text-align: center;">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- CHECKOUT -->
    <section class="page" data-route="/checkout" data-title="Checkout">
        <div class="container">
            <div class="grid-3">
                <!-- Left -->
                <div class="card reveal" style="grid-column: span 2;">
                    <h3>Order Summary</h3>
                    <div style="margin: 1.5rem 0; padding: 1rem; background: var(--panel); border-radius: 12px;">
                        <h4 id="summary-pkg-name" style="font-family: var(--font-display);">Select a Package</h4>
                        <p id="summary-pkg-desc" style="color: var(--muted); font-size: 0.9rem;">Please select a package from Pricing.</p>
                    </div>
                    
                    <div style="display: grid; gap: 10px; margin-bottom: 2rem;">
                        <div style="display:flex; justify-content:space-between;"><span>Setup Fee:</span><span id="summary-setup">RM 0</span></div>
                        <div style="display:flex; justify-content:space-between;"><span>Recurring:</span><span id="summary-recurring">RM 0</span></div>
                        <div style="display:flex; justify-content:space-between; font-weight: 700; font-size: 1.2rem; border-top: 1px solid var(--border); padding-top: 10px;">
                            <span>Total</span><span id="summary-final-total">RM 0</span>
                        </div>
                    </div>

                    <div id="checkout-actions">
                         <button class="btn btn-primary" style="width: 100%;" onclick="initiateRazorpayPayment()">Pay Now</button>
                         <div style="margin-top: 1rem; text-align: center;">
                             <input type="checkbox" id="terms-check" style="margin-right: 5px;">
                             <label for="terms-check" style="font-size: 0.9rem; color: var(--muted);">I agree to <a href="/terms" data-link style="color: var(--brand);">Terms</a></label>
                         </div>
                    </div>
                </div>

                <!-- Right -->
                <div class="card reveal">
                    <h3>Configuration</h3>
                    <form class="form" style="margin-top: 1rem;" onsubmit="return false;">
                        <input class="input" type="text" id="co-name" placeholder="Full Name" required>
                        <input class="input" type="tel" id="co-phone" placeholder="Phone" required>
                        <input class="input" type="email" id="co-email" placeholder="Email" required>
                        
                        <div style="margin-top: 1rem;">
                            <label style="font-size: 0.85rem; color: var(--muted); margin-bottom: 5px; display:block;">Domain Type</label>
                            <select class="input form-select" id="co-domain-type" onchange="updateCheckoutDomain()">
                                <option value="sub">Free Subdomain (.ddnet.my)</option>
                                <option value="custom">Custom Domain</option>
                            </select>
                            <input class="input" type="text" id="co-domain-name" placeholder="yourname" style="margin-top: 5px;">
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
    
    <!-- HELPDESK -->
    <section class="page" data-route="/helpdesk" data-title="Helpdesk">
        <div class="container" style="max-width: 800px;">
            <div class="card reveal">
                <h2 class="section-title">Helpdesk</h2>
                <p style="color: var(--muted); margin-bottom: 1rem;">Submit a ticket or check status.</p>
                
                <form class="form" onsubmit="handleTicketSubmit(event)">
                    <input class="input" type="text" id="ticket-name" placeholder="Name" required>
                    <input class="input" type="email" id="ticket-email" placeholder="Email" required>
                    <select class="input form-select" id="ticket-type">
                        <option>Payment Issue</option>
                        <option>Website Error</option>
                        <option>Other</option>
                    </select>
                    <textarea class="textarea" id="ticket-message" placeholder="Describe your issue..." required></textarea>
                    <button type="submit" class="btn btn-primary">Submit Ticket</button>
                </form>
            </div>
        </div>
    </section>

    <!-- TERMS -->
    <section class="page" data-route="/terms" data-title="Terms — DDNetwork One">
      <div class="container">
        <h2 class="section-title reveal">Terms & Conditions</h2>
        <div class="card reveal" style="margin-top:18px;">
          <p><strong>Scope:</strong> Work includes only what is listed in the selected package or agreement.</p>
          <p style="margin-top:10px"><strong>Payments:</strong> Setup fees are non‑refundable. Subscriptions are billed in advance.</p>
          <p style="margin-top:10px"><strong>Delivery:</strong> Timelines depend on feedback and content readiness.</p>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container" style="display:grid; gap:16px;">
      <div style="display:flex; justify-content:space-between; gap:16px; flex-wrap:wrap;">
        <div>
          <div class="logo" style="margin-bottom:10px;">
            <img src="https://raw.githubusercontent.com/ddnetwork-one/ddnetwork-store/refs/heads/main/crop_ddnlogo.png" alt="Logo">
            DDNetwork One
          </div>
          Designed in Malaysia. Built for the world.
        </div>
        <div style="display:flex; gap:14px; align-items:center;">
          <a href="https://www.linkedin.com/in/muhammad-danial-danish-217bb82ba/" target="_blank">LinkedIn</a>
          <a href="https://www.instagram.com/ddnet.my/" target="_blank">Instagram</a>
        </div>
      </div>
      <div style="border-top:1px solid var(--border); padding-top:12px; font-size:0.9rem;">
        © 2025–2026 DD Cloud Network · DDNetwork One
      </div>
    </div>
  </footer>

  <div class="toast-wrap" id="toastWrap"></div>

  <script>
    // ==========================================
    // 1. CORE SETUP & FIREBASE
    // ==========================================
    const prefersReduced = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
    const toastWrap = document.getElementById("toastWrap");

    // Firebase Configuration (From Old Code)
    const firebaseConfig = {
        apiKey: "AIzaSyAwf31b-wpYQwPbd-3DxnqGVRw8g3xq938",
        authDomain: "ddnetwork-database.firebaseapp.com",
        projectId: "ddnetwork-database",
        storageBucket: "ddnetwork-database.firebasestorage.app",
        messagingSenderId: "699127560990",
        appId: "1:699127560990:web:vg8k3pcvhkomoeb99tr333960v6ohj5m."
    };
    
    let db, auth;
    try {
        firebase.initializeApp(firebaseConfig);
        db = firebase.firestore();
        auth = firebase.auth();
    } catch(e) { console.error("Firebase Error", e); }

    const RAZORPAY_KEY_ID = "rzp_live_SEL3cH71UlI5YI"; 
    const ADMIN_PHONE_NO = "60122600969"; 
    
    // ==========================================
    // 2. ROUTING SYSTEM (Merged)
    // ==========================================
    const routes = {
      "/": "home",
      "/pricing": "pricing",
      "/work": "work",
      "/reviews": "reviews",
      "/about": "about",
      "/contact": "contact",
      "/login": "login",
      "/signup": "signup",
      "/profile": "profile",
      "/checkout": "checkout",
      "/helpdesk": "helpdesk",
      "/terms": "terms"
    };

    const pages = Array.from(document.querySelectorAll(".page"));
    const navLinks = Array.from(document.querySelectorAll("[data-nav]"));
    const header = document.getElementById("siteHeader");
    const progress = document.getElementById("progress");
    const menuToggle = document.getElementById("menuToggle");
    const mobileMenu = document.getElementById("mobileMenu");
    const themeToggle = document.getElementById("themeToggle");

    const useHash = location.protocol === "file:";
    const normalize = (p) => (p.length > 1 && p.endsWith("/") ? p.slice(0, -1) : p);

    function getPath() {
      if (useHash) return normalize(location.hash.replace("#", "") || "/");
      return normalize(location.pathname);
    }

    function render(path, replace = false) {
      const route = routes[path] ? path : "/";
      const page = document.querySelector(`.page[data-route="${route}"]`);
      
      pages.forEach(p => p.classList.remove("active"));
      if (page) page.classList.add("active");
      
      document.title = page?.dataset.title || "DDNetwork One";
      navLinks.forEach(a => a.classList.toggle("active", a.getAttribute("href") === route));
      mobileMenu.classList.remove("open");

      if (!prefersReduced) window.scrollTo({ top: 0, behavior: "smooth" });
      else window.scrollTo(0, 0);

      setupReveal();
      
      // Page Specific Hooks
      if (route === '/profile' && auth.currentUser) loadProfileData();
      if (route === '/checkout') loadCheckoutData();
      if (route === '/reviews') loadReviews();
      if (route === '/work') loadPortfolio();

      if (!useHash) {
        if (replace) history.replaceState({ path: route }, "", route);
        else history.pushState({ path: route }, "", route);
      }
    }

    document.querySelectorAll("[data-link]").forEach(link => {
      link.addEventListener("click", (e) => {
        const href = link.getAttribute("href");
        if (!href || href.startsWith("http")) return;
        e.preventDefault();
        if (useHash) location.hash = href;
        else render(href);
      });
    });

    window.addEventListener(useHash ? "hashchange" : "popstate", () => {
      render(getPath(), true);
    });

    // ==========================================
    // 3. AUTHENTICATION & STATE
    // ==========================================
    
    function handleGoogleAuth() {
        const provider = new firebase.auth.GoogleAuthProvider();
        auth.signInWithPopup(provider).then(result => {
            const user = result.user;
            return db.collection("users").doc(user.uid).set({
                name: user.displayName || 'User',
                email: user.email,
                role: 'user'
            }, { merge: true });
        }).then(() => {
            showToast("Login Successful!", "success");
            render('/');
        }).catch(err => showToast(err.message, "error"));
    }

    function handleLogin(e) {
        e.preventDefault();
        const email = document.getElementById('login-email').value;
        const pass = document.getElementById('login-password').value;
        auth.signInWithEmailAndPassword(email, pass).then(() => {
            showToast("Welcome back!", "success");
            render('/');
        }).catch(err => showToast(err.message, "error"));
    }

    function handleSignup(e) {
        e.preventDefault();
        const name = document.getElementById('signup-name').value;
        const phone = document.getElementById('signup-phone').value;
        const email = document.getElementById('signup-email').value;
        const pass = document.getElementById('signup-password').value;

        auth.createUserWithEmailAndPassword(email, pass).then(cred => {
            return db.collection("users").doc(cred.user.uid).set({
                name: name,
                phone: phone,
                email: email,
                role: 'user',
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            });
        }).then(() => {
            showToast("Account Created!", "success");
            render('/');
        }).catch(err => showToast(err.message, "error"));
    }

    function handleLogout() {
        auth.signOut().then(() => {
            showToast("Logged out", "success");
            render('/');
        });
    }

    function updateHeader(user) {
        const navAuth = document.getElementById('nav-auth-state');
        const headerBtns = document.getElementById('header-auth-btns');
        const mobileAuth = document.getElementById('mobile-auth-links');

        if (user) {
            navAuth.innerHTML = `<a href="/profile" data-link data-nav>Profile</a>`;
            headerBtns.innerHTML = `<a href="/profile" class="btn btn-ghost" data-link>Account</a>`;
            mobileAuth.innerHTML = `<a href="/profile" data-link>Profile</a><a href="#" onclick="handleLogout()">Logout</a>`;
        } else {
            navAuth.innerHTML = '';
            headerBtns.innerHTML = `<a href="/login" class="btn btn-ghost" data-link>Login</a>`;
            mobileAuth.innerHTML = `<a href="/login" data-link>Login</a>`;
        }
        
        // Re-attach listeners for new data-link elements
        document.querySelectorAll('[data-link]').forEach(link => {
            link.removeEventListener('click', () => {});
            link.addEventListener('click', (e) => {
                const href = link.getAttribute("href");
                if (!href || href.startsWith("http")) return;
                e.preventDefault();
                if (useHash) location.hash = href;
                else render(href);
            });
        });
    }

    if(auth) {
        auth.onAuthStateChanged(user => {
            updateHeader(user);
            if(user) {
                db.collection("users").doc(user.uid).get().then(doc => {
                    if(doc.exists && doc.data().role === 'admin') {
                        // Add Admin Link if needed
                    }
                });
            }
        });
    }

    function loadProfileData() {
        if(!auth.currentUser) return;
        const uid = auth.currentUser.uid;
        
        db.collection("users").doc(uid).get().then(doc => {
            if(doc.exists) {
                const d = doc.data();
                document.getElementById('prof-name').value = d.name || '';
                document.getElementById('prof-email').value = d.email || '';
                document.getElementById('prof-phone').value = d.phone || '';
                document.getElementById('prof-company').value = d.company || '';
            }
        });

        db.collection("orders").where("userId", "==", uid).orderBy("timestamp", "desc").limit(10)
            .onSnapshot(snap => {
                const tbody = document.getElementById('order-history-body');
                tbody.innerHTML = '';
                if(snap.empty) {
                    tbody.innerHTML = '<tr><td colspan="4" style="text-align: center;">No orders</td></tr>';
                    return;
                }
                snap.forEach(doc => {
                    const d = doc.data();
                    const date = d.timestamp ? new Date(d.timestamp.seconds * 1000).toLocaleDateString() : '-';
                    tbody.innerHTML += `
                        <tr>
                            <td>${date}</td>
                            <td>${d.package}</td>
                            <td>${d.total}</td>
                            <td>${d.status}</td>
                        </tr>
                    `;
                });
            });
    }

    function handleProfileUpdate(e) {
        e.preventDefault();
        if(!auth.currentUser) return;
        const data = {
            name: document.getElementById('prof-name').value,
            phone: document.getElementById('prof-phone').value,
            company: document.getElementById('prof-company').value
        };
        db.collection("users").doc(auth.currentUser.uid).update(data)
            .then(() => showToast("Profile Updated", "success"))
            .catch(err => showToast(err.message, "error"));
    }

    // ==========================================
    // 4. PRICING & CHECKOUT LOGIC
    // ==========================================
    let state = {
        packageType: null,
        packagePrice: 0, 
        setupFee: 0,
        domainName: '',
        total: 0,
        billingCycle: 'monthly'
    };

    const PRICING_DATA = {
        html: { monthly: 99, onetime: 249, setup: 100 },
        frontend: { monthly: 249, onetime: 1399, setup: 200 },
        ai: { monthly: 349, onetime: 2499, setup: 400 }
    };

    function attemptSelectPackage(name, type) {
        if(!auth.currentUser) {
            showToast("Please login to purchase", "error");
            render('/login');
            return;
        }
        
        // Determine cycle from UI toggle if exists
        const activeToggle = document.querySelector('.toggle-btn.active');
        const cycle = activeToggle ? activeToggle.dataset.billing : 'monthly';

        state.packageType = type;
        state.billingCycle = cycle;

        if(cycle === 'monthly') {
            state.packagePrice = PRICING_DATA[type].monthly;
            state.setupFee = PRICING_DATA[type].setup;
        } else {
            state.packagePrice = PRICING_DATA[type].onetime;
            state.setupFee = 0;
        }

        state.total = state.packagePrice + state.setupFee;

        // Pre-fill checkout
        db.collection("users").doc(auth.currentUser.uid).get().then(doc => {
            if(doc.exists) {
                const d = doc.data();
                document.getElementById('co-name').value = d.name || '';
                document.getElementById('co-phone').value = d.phone || '';
                document.getElementById('co-email').value = d.email || '';
            }
        });

        render('/checkout');
        updateCheckoutUI(name);
    }

    function updateCheckoutUI(name) {
        document.getElementById('summary-pkg-name').innerText = name;
        document.getElementById('summary-pkg-desc').innerText = `Plan: ${state.billingCycle}`;
        document.getElementById('summary-setup').innerText = `RM ${state.setupFee}`;
        document.getElementById('summary-recurring').innerText = `RM ${state.packagePrice}`;
        document.getElementById('summary-final-total').innerText = `RM ${state.total}`;
    }

    function updateCheckoutDomain() {
        const type = document.getElementById('co-domain-type').value;
        const input = document.getElementById('co-domain-name');
        if(type === 'sub') {
            input.placeholder = "yourname (free .ddnet.my)";
        } else {
            input.placeholder = "www.yourdomain.com";
        }
    }

    function loadCheckoutData() {
        if(!state.packageType) {
            document.getElementById('summary-pkg-name').innerText = "No Package Selected";
            document.getElementById('checkout-actions').innerHTML = '<a href="/pricing" class="btn btn-primary" data-link>Select Package</a>';
        } else {
            updateCheckoutUI(state.packageType);
        }
    }

    function initiateRazorpayPayment() {
        const terms = document.getElementById('terms-check');
        if(!terms.checked) return showToast("Please accept Terms", "error");

        const name = document.getElementById('co-name').value;
        const phone = document.getElementById('co-phone').value;
        const email = document.getElementById('co-email').value;
        const domainType = document.getElementById('co-domain-type').value;
        const domainName = document.getElementById('co-domain-name').value;

        if(!name || !phone || !email) return showToast("Fill all details", "error");
        if(!domainName) return showToast("Enter domain name", "error");

        const amountInSubunits = state.total * 100; // Convert to cents

        const options = {
            "key": RAZORPAY_KEY_ID,
            "amount": amountInSubunits,
            "currency": "MYR",
            "name": "DDNetwork One",
            "description": document.getElementById('summary-pkg-name').innerText,
            "handler": function (response){
                // Success
                saveOrder(response.razorpay_payment_id);
            },
            "prefill": {
                "name": name,
                "email": email,
                "contact": phone
            },
            "theme": { "color": "#0b0f14" }
        };

        const rzp = new Razorpay(options);
        rzp.open();
    }

    function saveOrder(paymentId) {
        const orderData = {
            userId: auth.currentUser.uid,
            name: document.getElementById('co-name').value,
            email: document.getElementById('co-email').value,
            phone: document.getElementById('co-phone').value,
            package: document.getElementById('summary-pkg-name').innerText,
            domain: document.getElementById('co-domain-name').value,
            domainType: document.getElementById('co-domain-type').value,
            total: `RM ${state.total}`,
            paymentId: paymentId,
            status: 'Paid',
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };

        db.collection("orders").add(orderData).then(() => {
            showToast("Order Placed Successfully!", "success");
            render('/profile');
        }).catch(err => {
            console.error(err);
            showToast("Error saving order", "error");
        });
    }

    // ==========================================
    // 5. DYNAMIC CONTENT (Reviews, Portfolio, Contact)
    // ==========================================
    
    let selectedRating = 5;
    function setupStarRating() {
        const container = document.getElementById('star-input-container');
        if(!container) return;
        
        const stars = container.querySelectorAll('i');
        stars.forEach((star, index) => {
            star.style.color = index < selectedRating ? 'var(--brand-3)' : 'var(--muted)';
            star.addEventListener('click', () => {
                selectedRating = index + 1;
                document.getElementById('rating-value').value = selectedRating;
                stars.forEach((s, i) => s.style.color = i < selectedRating ? 'var(--brand-3)' : 'var(--muted)');
            });
        });
    }

    function handleReviewSubmit(e) {
        e.preventDefault();
        if(!auth.currentUser) {
            showToast("Please login to review", "error");
            return;
        }
        
        const comment = document.getElementById('review-comment').value;
        db.collection("users").doc(auth.currentUser.uid).get().then(doc => {
            const name = doc.exists ? doc.data().name : "User";
            return db.collection("customer_reviews").add({
                userId: auth.currentUser.uid,
                userName: name,
                rating: selectedRating,
                comment: comment,
                timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                status: 'approved'
            });
        }).then(() => {
            showToast("Review submitted!", "success");
            document.getElementById('review-comment').value = '';
        }).catch(err => showToast(err.message, "error"));
    }

    function loadReviews() {
        if(!db) return;
        const slider = document.getElementById('reviewSlider');
        const dots = document.getElementById('reviewDots');
        
        db.collection("customer_reviews").where("status", "==", "approved").limit(10).get().then(snap => {
            slider.innerHTML = '';
            dots.innerHTML = '';
            
            let index = 0;
            snap.forEach(doc => {
                const d = doc.data();
                const slide = document.createElement('div');
                slide.className = `review-slide ${index === 0 ? 'active' : ''}`;
                
                let starsHtml = '';
                for(let i=0; i<5; i++) starsHtml += `<i class="${i < d.rating ? 'ri-star-fill' : 'ri-star-line'}"></i>`;
                
                slide.innerHTML = `
                    <div class="stars">${starsHtml}</div>
                    <p>"${d.comment}"</p>
                    <strong>- ${d.userName}</strong>
                `;
                slider.appendChild(slide);
                
                const dot = document.createElement('div');
                dot.className = `dot ${index === 0 ? 'active' : ''}`;
                dot.onclick = () => {
                    document.querySelectorAll('.review-slide').forEach(s => s.classList.remove('active'));
                    document.querySelectorAll('.dot').forEach(d => d.classList.remove('active'));
                    slide.classList.add('active');
                    dot.classList.add('active');
                };
                dots.appendChild(dot);
                index++;
            });
        });
    }

    function loadPortfolio() {
        if(!db) return;
        const grid = document.getElementById('portfolio-grid');
        db.collection("clients_portfolio").where("status", "==", true).limit(6).get().then(snap => {
            grid.innerHTML = '';
            if(snap.empty) {
                grid.innerHTML = '<div class="text-center" style="grid-column: 1/-1;">No projects yet.</div>';
                return;
            }
            snap.forEach(doc => {
                const d = doc.data();
                grid.innerHTML += `
                    <div class="card work-card reveal visible">
                        <img src="${d.img}" alt="${d.name}">
                        <h3>${d.name}</h3>
                        <p>${d.desc || 'View Project'}</p>
                        <a href="${d.link}" target="_blank" class="btn btn-ghost" style="margin-top:10px;">Visit</a>
                    </div>
                `;
            });
        });
    }

    function handleContactSubmit(e) {
        e.preventDefault();
        const form = e.target;
        const data = {
            name: form.name.value,
            email: form.email.value,
            message: form.message.value,
            type: 'Contact',
            status: 'New',
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };

        db.collection("customer_requests").add(data).then(() => {
            showToast("Message Sent!", "success");
            form.reset();
        }).catch(err => showToast(err.message, "error"));
    }

    function handleTicketSubmit(e) {
        e.preventDefault();
        const data = {
            name: document.getElementById('ticket-name').value,
            email: document.getElementById('ticket-email').value,
            type: document.getElementById('ticket-type').value,
            message: document.getElementById('ticket-message').value,
            status: 'Open',
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };

        db.collection("tickets").add(data).then(() => {
            showToast("Ticket Submitted!", "success");
            e.target.reset();
        }).catch(err => showToast(err.message, "error"));
    }

    // ==========================================
    // 6. UI UTILITIES
    // ==========================================
    
    menuToggle?.addEventListener("click", () => mobileMenu.classList.toggle("open"));

    themeToggle?.addEventListener("click", () => {
      const isLight = document.body.classList.toggle("theme-light");
      themeToggle.setAttribute("aria-pressed", String(isLight));
      themeToggle.innerHTML = isLight ? '<i class="ri-moon-line"></i>' : '<i class="ri-sun-line"></i>';
      localStorage.setItem("ddn-theme", isLight ? "light" : "dark");
    });

    if (localStorage.getItem("ddn-theme") === "light") {
      document.body.classList.add("theme-light");
      themeToggle.setAttribute("aria-pressed", "true");
      themeToggle.innerHTML = '<i class="ri-moon-line"></i>';
    }

    function updateProgress() {
      const h = document.documentElement.scrollHeight - window.innerHeight;
      const ratio = h > 0 ? window.scrollY / h : 0;
      progress.style.transform = `scaleX(${ratio})`;
      if (window.scrollY > 40) header.classList.add("scrolled");
      else header.classList.remove("scrolled");
    }
    window.addEventListener("scroll", updateProgress, { passive: true });

    let revealObserver;
    function setupReveal() {
      if (prefersReduced) {
        document.querySelectorAll(".page.active .reveal").forEach(el => el.classList.add("visible"));
        return;
      }
      if (revealObserver) revealObserver.disconnect();
      revealObserver = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) entry.target.classList.add("visible");
        });
      }, { threshold: 0.2 });
      document.querySelectorAll(".page.active .reveal").forEach(el => revealObserver.observe(el));
    }

    // Pricing Toggle Logic
    const pricingData = {
      starter: { monthly: 99, onetime: 249 },
      growth: { monthly: 249, onetime: 1399 },
      ai: { monthly: 349, onetime: 2499 }
    };
    document.querySelectorAll("[data-billing]").forEach(btn => {
      btn.addEventListener("click", () => {
        const billing = btn.dataset.billing;
        document.querySelectorAll("[data-billing]").forEach(b => b.classList.toggle("active", b.dataset.billing === billing));
        document.querySelectorAll("[data-price]").forEach(el => {
          const key = el.dataset.price;
          const value = pricingData[key][billing];
          el.innerHTML = `RM ${value} <span>/${billing === "monthly" ? "month" : "one‑time"}</span>`;
        });
      });
    });

    function showToast(message, type = 'info') {
        const t = document.createElement("div");
        t.className = "toast";
        t.textContent = message;
        if(type === 'error') t.style.borderLeft = '3px solid var(--danger)';
        if(type === 'success') t.style.borderLeft = '3px solid var(--accent-success)';
        toastWrap.appendChild(t);
        setTimeout(() => t.remove(), 3000);
    }

    // Init
    render(getPath(), true);

  </script>
</body>
</html>
